"use strict";var e=require("./index-2ba926b7.js"),t=require("url"),n=require("buffer"),r=require("http"),o=require("fs"),i=require("os"),s=require("path"),a=require("crypto"),u=require("https"),c=require("stream");require("http2");var l=require("process"),d=require("child_process"),f=require("./regeneration-handler-13d8a068.js");function v(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}require("zlib"),require("./manifest.json");var h,g,_,p,m,y,w,b,S,E,A,x,T,R,I,k,P,C,O,z,N,D,L,U,q,j,M,H,W,K=v(a),$="3.30.0",F="3.30.0";!function(t){t.filterSensitiveLog=function(t){return e.__assign({},t)}}(h||(h={})),function(t){t.filterSensitiveLog=function(t){return e.__assign({},t)}}(g||(g={})),function(t){t.filterSensitiveLog=function(t){return e.__assign({},t)}}(_||(_={})),function(t){t.filterSensitiveLog=function(t){return e.__assign({},t)}}(p||(p={})),function(t){t.filterSensitiveLog=function(t){return e.__assign({},t)}}(m||(m={})),function(t){t.filterSensitiveLog=function(t){return e.__assign({},t)}}(y||(y={})),function(t){t.filterSensitiveLog=function(t){return e.__assign({},t)}}(w||(w={})),function(t){t.filterSensitiveLog=function(t){return e.__assign({},t)}}(b||(b={})),function(t){t.filterSensitiveLog=function(t){return e.__assign({},t)}}(S||(S={})),function(t){t.filterSensitiveLog=function(t){return e.__assign({},t)}}(E||(E={})),function(t){t.filterSensitiveLog=function(t){return e.__assign({},t)}}(A||(A={})),function(t){t.filterSensitiveLog=function(t){return e.__assign({},t)}}(x||(x={})),function(t){t.filterSensitiveLog=function(t){return e.__assign({},t)}}(T||(T={})),function(t){t.filterSensitiveLog=function(t){return e.__assign({},t)}}(R||(R={})),function(t){t.filterSensitiveLog=function(t){return e.__assign({},t)}}(I||(I={})),function(t){t.filterSensitiveLog=function(t){return e.__assign({},t)}}(k||(k={})),function(t){t.filterSensitiveLog=function(t){return e.__assign({},t)}}(P||(P={})),function(t){t.filterSensitiveLog=function(t){return e.__assign({},t)}}(C||(C={})),function(t){t.filterSensitiveLog=function(t){return e.__assign({},t)}}(O||(O={})),function(t){t.filterSensitiveLog=function(t){return e.__assign({},t)}}(z||(z={})),function(t){t.filterSensitiveLog=function(t){return e.__assign({},t)}}(N||(N={})),function(t){t.filterSensitiveLog=function(t){return e.__assign({},t)}}(D||(D={})),function(t){t.filterSensitiveLog=function(t){return e.__assign({},t)}}(L||(L={})),function(t){t.filterSensitiveLog=function(t){return e.__assign({},t)}}(U||(U={})),function(t){t.filterSensitiveLog=function(t){return e.__assign({},t)}}(q||(q={})),function(t){t.filterSensitiveLog=function(t){return e.__assign({},t)}}(j||(j={})),function(t){t.filterSensitiveLog=function(t){return e.__assign({},t)}}(M||(M={})),function(t){t.filterSensitiveLog=function(t){return e.__assign({},t)}}(H||(H={})),function(t){t.filterSensitiveLog=function(t){return e.__assign({},t)}}(W||(W={}));var V=!1,B=function(e){e&&!V&&parseInt(e.substring(1,e.indexOf(".")))<12&&(V=!0,process.emitWarning("The AWS SDK for JavaScript (v3) will\nno longer support Node.js "+e+" as of January 1, 2022.\nTo continue receiving updates to AWS services, bug fixes, and security\nupdates please upgrade to Node.js 12.x or later.\n\nMore information can be found at: https://a.co/1l6FLnu","NodeDeprecationWarning"))},G=function(t,n){return e.__awaiter(void 0,void 0,void 0,(function(){var r,o,i,s,a,u,c,l,d,f,v;return e.__generator(this,(function(h){switch(h.label){case 0:return o=[e.__assign({},t)],v={},[4,Ae(t.body,n)];case 1:switch(r=e.__assign.apply(void 0,o.concat([(v.body=h.sent(),v)])),s="UnknownError",s=Te(t,r.body),s){case"ExpiredTokenException":case"com.amazonaws.sts#ExpiredTokenException":return[3,2];case"MalformedPolicyDocumentException":case"com.amazonaws.sts#MalformedPolicyDocumentException":return[3,4];case"PackedPolicyTooLargeException":case"com.amazonaws.sts#PackedPolicyTooLargeException":return[3,6];case"RegionDisabledException":case"com.amazonaws.sts#RegionDisabledException":return[3,8]}return[3,10];case 2:return a=[{}],[4,J(r,n)];case 3:return i=e.__assign.apply(void 0,[e.__assign.apply(void 0,a.concat([h.sent()])),{name:s,$metadata:be(t)}]),[3,11];case 4:return u=[{}],[4,ee(r,n)];case 5:return i=e.__assign.apply(void 0,[e.__assign.apply(void 0,u.concat([h.sent()])),{name:s,$metadata:be(t)}]),[3,11];case 6:return c=[{}],[4,te(r,n)];case 7:return i=e.__assign.apply(void 0,[e.__assign.apply(void 0,c.concat([h.sent()])),{name:s,$metadata:be(t)}]),[3,11];case 8:return l=[{}],[4,ne(r,n)];case 9:return i=e.__assign.apply(void 0,[e.__assign.apply(void 0,l.concat([h.sent()])),{name:s,$metadata:be(t)}]),[3,11];case 10:d=r.body,s=d.Error.code||d.Error.Code||s,i=e.__assign(e.__assign({},d.Error),{name:""+s,message:d.Error.message||d.Error.Message||s,$fault:"client",$metadata:be(t)}),h.label=11;case 11:return f=i.message||i.Message||s,i.message=f,delete i.Message,[2,Promise.reject(Object.assign(new Error(f),i))]}}))}))},X=function(t,n){return e.__awaiter(void 0,void 0,void 0,(function(){var r,o,i,s,a,u,c,l,d,f,v,h,g,_;return e.__generator(this,(function(p){switch(p.label){case 0:return o=[e.__assign({},t)],_={},[4,Ae(t.body,n)];case 1:switch(r=e.__assign.apply(void 0,o.concat([(_.body=p.sent(),_)])),s="UnknownError",s=Te(t,r.body),s){case"ExpiredTokenException":case"com.amazonaws.sts#ExpiredTokenException":return[3,2];case"IDPCommunicationErrorException":case"com.amazonaws.sts#IDPCommunicationErrorException":return[3,4];case"IDPRejectedClaimException":case"com.amazonaws.sts#IDPRejectedClaimException":return[3,6];case"InvalidIdentityTokenException":case"com.amazonaws.sts#InvalidIdentityTokenException":return[3,8];case"MalformedPolicyDocumentException":case"com.amazonaws.sts#MalformedPolicyDocumentException":return[3,10];case"PackedPolicyTooLargeException":case"com.amazonaws.sts#PackedPolicyTooLargeException":return[3,12];case"RegionDisabledException":case"com.amazonaws.sts#RegionDisabledException":return[3,14]}return[3,16];case 2:return a=[{}],[4,J(r,n)];case 3:return i=e.__assign.apply(void 0,[e.__assign.apply(void 0,a.concat([p.sent()])),{name:s,$metadata:be(t)}]),[3,17];case 4:return u=[{}],[4,Y(r,n)];case 5:return i=e.__assign.apply(void 0,[e.__assign.apply(void 0,u.concat([p.sent()])),{name:s,$metadata:be(t)}]),[3,17];case 6:return c=[{}],[4,Z(r,n)];case 7:return i=e.__assign.apply(void 0,[e.__assign.apply(void 0,c.concat([p.sent()])),{name:s,$metadata:be(t)}]),[3,17];case 8:return l=[{}],[4,Q(r,n)];case 9:return i=e.__assign.apply(void 0,[e.__assign.apply(void 0,l.concat([p.sent()])),{name:s,$metadata:be(t)}]),[3,17];case 10:return d=[{}],[4,ee(r,n)];case 11:return i=e.__assign.apply(void 0,[e.__assign.apply(void 0,d.concat([p.sent()])),{name:s,$metadata:be(t)}]),[3,17];case 12:return f=[{}],[4,te(r,n)];case 13:return i=e.__assign.apply(void 0,[e.__assign.apply(void 0,f.concat([p.sent()])),{name:s,$metadata:be(t)}]),[3,17];case 14:return v=[{}],[4,ne(r,n)];case 15:return i=e.__assign.apply(void 0,[e.__assign.apply(void 0,v.concat([p.sent()])),{name:s,$metadata:be(t)}]),[3,17];case 16:h=r.body,s=h.Error.code||h.Error.Code||s,i=e.__assign(e.__assign({},h.Error),{name:""+s,message:h.Error.message||h.Error.Message||s,$fault:"client",$metadata:be(t)}),p.label=17;case 17:return g=i.message||i.Message||s,i.message=g,delete i.Message,[2,Promise.reject(Object.assign(new Error(g),i))]}}))}))},J=function(t,n){return e.__awaiter(void 0,void 0,void 0,(function(){var r,o;return e.__generator(this,(function(i){return r=t.body,o=he(r.Error,n),[2,e.__assign({name:"ExpiredTokenException",$fault:"client",$metadata:be(t)},o)]}))}))},Y=function(t,n){return e.__awaiter(void 0,void 0,void 0,(function(){var r,o;return e.__generator(this,(function(i){return r=t.body,o=ge(r.Error,n),[2,e.__assign({name:"IDPCommunicationErrorException",$fault:"client",$metadata:be(t)},o)]}))}))},Z=function(t,n){return e.__awaiter(void 0,void 0,void 0,(function(){var r,o;return e.__generator(this,(function(i){return r=t.body,o=_e(r.Error,n),[2,e.__assign({name:"IDPRejectedClaimException",$fault:"client",$metadata:be(t)},o)]}))}))},Q=function(t,n){return e.__awaiter(void 0,void 0,void 0,(function(){var r,o;return e.__generator(this,(function(i){return r=t.body,o=pe(r.Error,n),[2,e.__assign({name:"InvalidIdentityTokenException",$fault:"client",$metadata:be(t)},o)]}))}))},ee=function(t,n){return e.__awaiter(void 0,void 0,void 0,(function(){var r,o;return e.__generator(this,(function(i){return r=t.body,o=me(r.Error,n),[2,e.__assign({name:"MalformedPolicyDocumentException",$fault:"client",$metadata:be(t)},o)]}))}))},te=function(t,n){return e.__awaiter(void 0,void 0,void 0,(function(){var r,o;return e.__generator(this,(function(i){return r=t.body,o=ye(r.Error,n),[2,e.__assign({name:"PackedPolicyTooLargeException",$fault:"client",$metadata:be(t)},o)]}))}))},ne=function(t,n){return e.__awaiter(void 0,void 0,void 0,(function(){var r,o;return e.__generator(this,(function(i){return r=t.body,o=we(r.Error,n),[2,e.__assign({name:"RegionDisabledException",$fault:"client",$metadata:be(t)},o)]}))}))},re=function(t,n){var r={};if(void 0!==t.RoleArn&&null!==t.RoleArn&&(r.RoleArn=t.RoleArn),void 0!==t.RoleSessionName&&null!==t.RoleSessionName&&(r.RoleSessionName=t.RoleSessionName),void 0!==t.PolicyArns&&null!==t.PolicyArns){var o=ie(t.PolicyArns,n);Object.entries(o).forEach((function(t){var n=e.__read(t,2),o=n[0],i=n[1];r["PolicyArns."+o]=i}))}if(void 0!==t.Policy&&null!==t.Policy&&(r.Policy=t.Policy),void 0!==t.DurationSeconds&&null!==t.DurationSeconds&&(r.DurationSeconds=t.DurationSeconds),void 0!==t.Tags&&null!==t.Tags){o=ce(t.Tags,n);Object.entries(o).forEach((function(t){var n=e.__read(t,2),o=n[0],i=n[1];r["Tags."+o]=i}))}if(void 0!==t.TransitiveTagKeys&&null!==t.TransitiveTagKeys){o=ue(t.TransitiveTagKeys,n);Object.entries(o).forEach((function(t){var n=e.__read(t,2),o=n[0],i=n[1];r["TransitiveTagKeys."+o]=i}))}return void 0!==t.ExternalId&&null!==t.ExternalId&&(r.ExternalId=t.ExternalId),void 0!==t.SerialNumber&&null!==t.SerialNumber&&(r.SerialNumber=t.SerialNumber),void 0!==t.TokenCode&&null!==t.TokenCode&&(r.TokenCode=t.TokenCode),void 0!==t.SourceIdentity&&null!==t.SourceIdentity&&(r.SourceIdentity=t.SourceIdentity),r},oe=function(t,n){var r={};if(void 0!==t.RoleArn&&null!==t.RoleArn&&(r.RoleArn=t.RoleArn),void 0!==t.RoleSessionName&&null!==t.RoleSessionName&&(r.RoleSessionName=t.RoleSessionName),void 0!==t.WebIdentityToken&&null!==t.WebIdentityToken&&(r.WebIdentityToken=t.WebIdentityToken),void 0!==t.ProviderId&&null!==t.ProviderId&&(r.ProviderId=t.ProviderId),void 0!==t.PolicyArns&&null!==t.PolicyArns){var o=ie(t.PolicyArns,n);Object.entries(o).forEach((function(t){var n=e.__read(t,2),o=n[0],i=n[1];r["PolicyArns."+o]=i}))}return void 0!==t.Policy&&null!==t.Policy&&(r.Policy=t.Policy),void 0!==t.DurationSeconds&&null!==t.DurationSeconds&&(r.DurationSeconds=t.DurationSeconds),r},ie=function(t,n){var r,o,i={},s=1;try{for(var a=e.__values(t),u=a.next();!u.done;u=a.next()){var c=u.value;if(null!==c){var l=se(c,n);Object.entries(l).forEach((function(t){var n=e.__read(t,2),r=n[0],o=n[1];i["member."+s+"."+r]=o})),s++}}}catch(e){r={error:e}}finally{try{u&&!u.done&&(o=a.return)&&o.call(a)}finally{if(r)throw r.error}}return i},se=function(e,t){var n={};return void 0!==e.arn&&null!==e.arn&&(n.arn=e.arn),n},ae=function(e,t){var n={};return void 0!==e.Key&&null!==e.Key&&(n.Key=e.Key),void 0!==e.Value&&null!==e.Value&&(n.Value=e.Value),n},ue=function(t,n){var r,o,i={},s=1;try{for(var a=e.__values(t),u=a.next();!u.done;u=a.next()){var c=u.value;null!==c&&(i["member."+s]=c,s++)}}catch(e){r={error:e}}finally{try{u&&!u.done&&(o=a.return)&&o.call(a)}finally{if(r)throw r.error}}return i},ce=function(t,n){var r,o,i={},s=1;try{for(var a=e.__values(t),u=a.next();!u.done;u=a.next()){var c=u.value;if(null!==c){var l=ae(c);Object.entries(l).forEach((function(t){var n=e.__read(t,2),r=n[0],o=n[1];i["member."+s+"."+r]=o})),s++}}}catch(e){r={error:e}}finally{try{u&&!u.done&&(o=a.return)&&o.call(a)}finally{if(r)throw r.error}}return i},le=function(t,n){var r={AssumedRoleId:void 0,Arn:void 0};return void 0!==t.AssumedRoleId&&(r.AssumedRoleId=e.expectString(t.AssumedRoleId)),void 0!==t.Arn&&(r.Arn=e.expectString(t.Arn)),r},de=function(t,n){var r={Credentials:void 0,AssumedRoleUser:void 0,PackedPolicySize:void 0,SourceIdentity:void 0};return void 0!==t.Credentials&&(r.Credentials=ve(t.Credentials,n)),void 0!==t.AssumedRoleUser&&(r.AssumedRoleUser=le(t.AssumedRoleUser)),void 0!==t.PackedPolicySize&&(r.PackedPolicySize=e.strictParseInt32(t.PackedPolicySize)),void 0!==t.SourceIdentity&&(r.SourceIdentity=e.expectString(t.SourceIdentity)),r},fe=function(t,n){var r={Credentials:void 0,SubjectFromWebIdentityToken:void 0,AssumedRoleUser:void 0,PackedPolicySize:void 0,Provider:void 0,Audience:void 0,SourceIdentity:void 0};return void 0!==t.Credentials&&(r.Credentials=ve(t.Credentials,n)),void 0!==t.SubjectFromWebIdentityToken&&(r.SubjectFromWebIdentityToken=e.expectString(t.SubjectFromWebIdentityToken)),void 0!==t.AssumedRoleUser&&(r.AssumedRoleUser=le(t.AssumedRoleUser)),void 0!==t.PackedPolicySize&&(r.PackedPolicySize=e.strictParseInt32(t.PackedPolicySize)),void 0!==t.Provider&&(r.Provider=e.expectString(t.Provider)),void 0!==t.Audience&&(r.Audience=e.expectString(t.Audience)),void 0!==t.SourceIdentity&&(r.SourceIdentity=e.expectString(t.SourceIdentity)),r},ve=function(t,n){var r={AccessKeyId:void 0,SecretAccessKey:void 0,SessionToken:void 0,Expiration:void 0};return void 0!==t.AccessKeyId&&(r.AccessKeyId=e.expectString(t.AccessKeyId)),void 0!==t.SecretAccessKey&&(r.SecretAccessKey=e.expectString(t.SecretAccessKey)),void 0!==t.SessionToken&&(r.SessionToken=e.expectString(t.SessionToken)),void 0!==t.Expiration&&(r.Expiration=new Date(t.Expiration)),r},he=function(t,n){var r={message:void 0};return void 0!==t.message&&(r.message=e.expectString(t.message)),r},ge=function(t,n){var r={message:void 0};return void 0!==t.message&&(r.message=e.expectString(t.message)),r},_e=function(t,n){var r={message:void 0};return void 0!==t.message&&(r.message=e.expectString(t.message)),r},pe=function(t,n){var r={message:void 0};return void 0!==t.message&&(r.message=e.expectString(t.message)),r},me=function(t,n){var r={message:void 0};return void 0!==t.message&&(r.message=e.expectString(t.message)),r},ye=function(t,n){var r={message:void 0};return void 0!==t.message&&(r.message=e.expectString(t.message)),r},we=function(t,n){var r={message:void 0};return void 0!==t.message&&(r.message=e.expectString(t.message)),r},be=function(e){var t;return{httpStatusCode:e.statusCode,requestId:null!==(t=e.headers["x-amzn-requestid"])&&void 0!==t?t:e.headers["x-amzn-request-id"],extendedRequestId:e.headers["x-amz-id-2"],cfId:e.headers["x-amz-cf-id"]}},Se=function(e,t){return function(e,t){return void 0===e&&(e=new Uint8Array),e instanceof Uint8Array?Promise.resolve(e):t.streamCollector(e)||Promise.resolve(new Uint8Array)}(e,t).then((function(e){return t.utf8Encoder(e)}))},Ee=function(t,n,r,o,i){return e.__awaiter(void 0,void 0,void 0,(function(){var s,a,u,c,l,d,f;return e.__generator(this,(function(v){switch(v.label){case 0:return[4,t.endpoint()];case 1:return s=v.sent(),a=s.hostname,u=s.protocol,c=void 0===u?"https":u,l=s.port,d=s.path,f={protocol:c,hostname:a,port:l,method:"POST",path:d.endsWith("/")?d.slice(0,-1)+r:d+r,headers:n},void 0!==o&&(f.hostname=o),void 0!==i&&(f.body=i),[2,new e.HttpRequest(f)]}}))}))},Ae=function(t,n){return Se(t,n).then((function(t){if(t.length){var n=e.parser.parse(t,{attributeNamePrefix:"",ignoreAttributes:!1,parseNodeValue:!1,trimValues:!1,tagValueProcessor:function(t){return""===t.trim()&&t.includes("\n")?"":e.lib.decodeHTML(t)}}),r=Object.keys(n)[0],o=n[r];return o["#text"]&&(o[r]=o["#text"],delete o["#text"]),e.getValueFromTextNode(o)}return{}}))},xe=function(t){return Object.entries(t).map((function(t){var n=e.__read(t,2),r=n[0],o=n[1];return e.extendedEncodeURIComponent(r)+"="+e.extendedEncodeURIComponent(o)})).join("&")},Te=function(e,t){return void 0!==t.Error.Code?t.Error.Code:404==e.statusCode?"NotFound":""},Re=function(t){function n(e,n){void 0===n&&(n=!0);var r=t.call(this,e)||this;return r.tryNextLink=n,r}return e.__extends(n,t),n.from=function(e,t){return void 0===t&&(t=!0),Object.defineProperty(e,"tryNextLink",{value:t,configurable:!1,enumerable:!1,writable:!1}),e},n}(Error),Ie=function(t){function n(e,n){void 0===n&&(n=!0);var r=t.call(this,e)||this;return r.tryNextLink=n,r.name="CredentialsProviderError",r}return e.__extends(n,t),n.from=function(e,t){return void 0===t&&(t=!0),Object.defineProperty(e,"tryNextLink",{value:t,configurable:!1,enumerable:!1,writable:!1}),e},n}(Error);function ke(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return function(){var n,r,o=Promise.reject(new Re("No providers in chain")),i=function(e){o=o.catch((function(t){if(null==t?void 0:t.tryNextLink)return e();throw t}))};try{for(var s=e.__values(t),a=s.next();!a.done;a=s.next()){i(a.value)}}catch(e){n={error:e}}finally{try{a&&!a.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}return o}}for(var Pe=function(t,n,r){var o,i,s,a=function(){return e.__awaiter(void 0,void 0,void 0,(function(){return e.__generator(this,(function(e){switch(e.label){case 0:i||(i=t()),e.label=1;case 1:return e.trys.push([1,,3,4]),[4,i];case 2:return o=e.sent(),s=!0,[3,4];case 3:return i=void 0,[7];case 4:return[2,o]}}))}))};if(void 0===n)return function(){return e.__awaiter(void 0,void 0,void 0,(function(){return e.__generator(this,(function(e){switch(e.label){case 0:return s?[3,2]:[4,a()];case 1:o=e.sent(),e.label=2;case 2:return[2,o]}}))}))};var u=!1;return function(){return e.__awaiter(void 0,void 0,void 0,(function(){return e.__generator(this,(function(e){switch(e.label){case 0:return s?[3,2]:[4,a()];case 1:o=e.sent(),e.label=2;case 2:return u?[2,o]:r&&!r(o)?(u=!0,[2,o]):n(o)?[4,a()]:[3,4];case 3:return e.sent(),[2,o];case 4:return[2,o]}}))}))}},Ce={},Oe={},ze=0;ze<256;ze++){var Ne=ze.toString(16).toLowerCase();1===Ne.length&&(Ne="0"+Ne),Ce[ze]=Ne,Oe[Ne]=ze}function De(e){for(var t="",n=0;n<e.byteLength;n++)t+=Ce[e[n]];return t}var Le="X-Amz-Date".toLowerCase(),Ue=["authorization",Le,"date"],qe="X-Amz-Signature".toLowerCase(),je="X-Amz-Security-Token".toLowerCase(),Me={authorization:!0,"cache-control":!0,connection:!0,expect:!0,from:!0,"keep-alive":!0,"max-forwards":!0,pragma:!0,referer:!0,te:!0,trailer:!0,"transfer-encoding":!0,upgrade:!0,"user-agent":!0,"x-amzn-trace-id":!0},He=/^proxy-/,We=/^sec-/,Ke="AWS4-HMAC-SHA256-PAYLOAD",$e={},Fe=[];function Ve(e,t,n){return e+"/"+t+"/"+n+"/aws4_request"}function Be(e,t,n){var r=new e(t);return r.update(n),r.digest()}function Ge(t,n,r){var o,i,s=t.headers,a={};try{for(var u=e.__values(Object.keys(s).sort()),c=u.next();!c.done;c=u.next()){var l=c.value,d=l.toLowerCase();(d in Me||(null==n?void 0:n.has(d))||He.test(d)||We.test(d))&&(!r||r&&!r.has(d))||(a[d]=s[l].trim().replace(/\s+/g," "))}}catch(e){o={error:e}}finally{try{c&&!c.done&&(i=u.return)&&i.call(u)}finally{if(o)throw o.error}}return a}var Xe=function(e){return encodeURIComponent(e).replace(/[!'()*]/g,Je)},Je=function(e){return"%"+e.charCodeAt(0).toString(16).toUpperCase()};var Ye=function(e){return"function"==typeof ArrayBuffer&&e instanceof ArrayBuffer||"[object ArrayBuffer]"===Object.prototype.toString.call(e)};function Ze(t,n){var r=t.headers,o=t.body;return e.__awaiter(this,void 0,void 0,(function(){var t,i,s,a,u,c,l;return e.__generator(this,(function(d){switch(d.label){case 0:try{for(t=e.__values(Object.keys(r)),i=t.next();!i.done;i=t.next())if("x-amz-content-sha256"===(s=i.value).toLowerCase())return[2,r[s]]}catch(e){c={error:e}}finally{try{i&&!i.done&&(l=t.return)&&l.call(t)}finally{if(c)throw c.error}}return null!=o?[3,1]:[2,"e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855"];case 1:return"string"==typeof o||ArrayBuffer.isView(o)||Ye(o)?((a=new n).update(o),u=De,[4,a.digest()]):[3,3];case 2:return[2,u.apply(void 0,[d.sent()])];case 3:return[2,"UNSIGNED-PAYLOAD"]}}))}))}function Qe(t){var n=t.headers,r=t.query,o=e.__rest(t,["headers","query"]);return e.__assign(e.__assign({},o),{headers:e.__assign({},n),query:r?et(r):void 0})}function et(t){return Object.keys(t).reduce((function(n,r){var o,i=t[r];return e.__assign(e.__assign({},n),((o={})[r]=Array.isArray(i)?e.__spreadArray([],e.__read(i),!1):i,o))}),{})}function tt(t){var n,r;t="function"==typeof t.clone?t.clone():Qe(t);try{for(var o=e.__values(Object.keys(t.headers)),i=o.next();!i.done;i=o.next()){var s=i.value;Ue.indexOf(s.toLowerCase())>-1&&delete t.headers[s]}}catch(e){n={error:e}}finally{try{i&&!i.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}return t}function nt(e){return function(e){if("number"==typeof e)return new Date(1e3*e);if("string"==typeof e)return Number(e)?new Date(1e3*Number(e)):new Date(e);return e}(e).toISOString().replace(/\.\d{3}Z$/,"Z")}var rt=function(){function t(e){var t=e.applyChecksum,n=e.credentials,r=e.region,o=e.service,i=e.sha256,s=e.uriEscapePath,a=void 0===s||s;this.service=o,this.sha256=i,this.uriEscapePath=a,this.applyChecksum="boolean"!=typeof t||t,this.regionProvider=st(r),this.credentialProvider=at(n)}return t.prototype.presign=function(t,n){return void 0===n&&(n={}),e.__awaiter(this,void 0,void 0,(function(){var r,o,i,s,a,u,c,l,d,f,v,h,g,_,p,m,y,w,b,S,E,A,x,T;return e.__generator(this,(function(R){switch(R.label){case 0:return r=n.signingDate,o=void 0===r?new Date:r,i=n.expiresIn,s=void 0===i?3600:i,a=n.unsignableHeaders,u=n.unhoistableHeaders,c=n.signableHeaders,l=n.signingRegion,d=n.signingService,[4,this.credentialProvider()];case 1:return f=R.sent(),null==l?[3,2]:(h=l,[3,4]);case 2:return[4,this.regionProvider()];case 3:h=R.sent(),R.label=4;case 4:return v=h,g=ot(o),_=g.longDate,p=g.shortDate,s>604800?[2,Promise.reject("Signature version 4 presigned URLs must have an expiration date less than one week in the future")]:(m=Ve(p,v,null!=d?d:this.service),y=function(t,n){var r,o,i;void 0===n&&(n={});var s="function"==typeof t.clone?t.clone():Qe(t),a=s.headers,u=s.query,c=void 0===u?{}:u;try{for(var l=e.__values(Object.keys(a)),d=l.next();!d.done;d=l.next()){var f=d.value,v=f.toLowerCase();"x-amz-"!==v.substr(0,6)||(null===(i=n.unhoistableHeaders)||void 0===i?void 0:i.has(v))||(c[f]=a[f],delete a[f])}}catch(e){r={error:e}}finally{try{d&&!d.done&&(o=l.return)&&o.call(l)}finally{if(r)throw r.error}}return e.__assign(e.__assign({},t),{headers:a,query:c})}(tt(t),{unhoistableHeaders:u}),f.sessionToken&&(y.query["X-Amz-Security-Token"]=f.sessionToken),y.query["X-Amz-Algorithm"]="AWS4-HMAC-SHA256",y.query["X-Amz-Credential"]=f.accessKeyId+"/"+m,y.query["X-Amz-Date"]=_,y.query["X-Amz-Expires"]=s.toString(10),w=Ge(y,a,c),y.query["X-Amz-SignedHeaders"]=it(w),b=y.query,S="X-Amz-Signature",E=this.getSignature,A=[_,m,this.getSigningKey(f,v,p,d)],x=this.createCanonicalRequest,T=[y,w],[4,Ze(t,this.sha256)]);case 5:return[4,E.apply(this,A.concat([x.apply(this,T.concat([R.sent()]))]))];case 6:return b[S]=R.sent(),[2,y]}}))}))},t.prototype.sign=function(t,n){return e.__awaiter(this,void 0,void 0,(function(){return e.__generator(this,(function(e){return"string"==typeof t?[2,this.signString(t,n)]:t.headers&&t.payload?[2,this.signEvent(t,n)]:[2,this.signRequest(t,n)]}))}))},t.prototype.signEvent=function(t,n){var r=t.headers,o=t.payload,i=n.signingDate,s=void 0===i?new Date:i,a=n.priorSignature,u=n.signingRegion,c=n.signingService;return e.__awaiter(this,void 0,void 0,(function(){var t,n,i,l,d,f,v,h,g,_,p;return e.__generator(this,(function(e){switch(e.label){case 0:return null==u?[3,1]:(n=u,[3,3]);case 1:return[4,this.regionProvider()];case 2:n=e.sent(),e.label=3;case 3:return t=n,i=ot(s),l=i.shortDate,d=i.longDate,f=Ve(l,t,null!=c?c:this.service),[4,Ze({headers:{},body:o},this.sha256)];case 4:return v=e.sent(),(h=new this.sha256).update(r),_=De,[4,h.digest()];case 5:return g=_.apply(void 0,[e.sent()]),p=[Ke,d,f,a,g,v].join("\n"),[2,this.signString(p,{signingDate:s,signingRegion:t,signingService:c})]}}))}))},t.prototype.signString=function(t,n){var r=void 0===n?{}:n,o=r.signingDate,i=void 0===o?new Date:o,s=r.signingRegion,a=r.signingService;return e.__awaiter(this,void 0,void 0,(function(){var n,r,o,u,c,l,d,f;return e.__generator(this,(function(e){switch(e.label){case 0:return[4,this.credentialProvider()];case 1:return n=e.sent(),null==s?[3,2]:(o=s,[3,4]);case 2:return[4,this.regionProvider()];case 3:o=e.sent(),e.label=4;case 4:return r=o,u=ot(i).shortDate,d=(l=this.sha256).bind,[4,this.getSigningKey(n,r,u,a)];case 5:return(c=new(d.apply(l,[void 0,e.sent()]))).update(t),f=De,[4,c.digest()];case 6:return[2,f.apply(void 0,[e.sent()])]}}))}))},t.prototype.signRequest=function(t,n){var r=void 0===n?{}:n,o=r.signingDate,i=void 0===o?new Date:o,s=r.signableHeaders,a=r.unsignableHeaders,u=r.signingRegion,c=r.signingService;return e.__awaiter(this,void 0,void 0,(function(){var n,r,o,l,d,f,v,h,g,_,p;return e.__generator(this,(function(m){switch(m.label){case 0:return[4,this.credentialProvider()];case 1:return n=m.sent(),null==u?[3,2]:(o=u,[3,4]);case 2:return[4,this.regionProvider()];case 3:o=m.sent(),m.label=4;case 4:return r=o,l=tt(t),d=ot(i),f=d.longDate,v=d.shortDate,h=Ve(v,r,null!=c?c:this.service),l.headers[Le]=f,n.sessionToken&&(l.headers[je]=n.sessionToken),[4,Ze(l,this.sha256)];case 5:return g=m.sent(),!function(t,n){var r,o;t=t.toLowerCase();try{for(var i=e.__values(Object.keys(n)),s=i.next();!s.done;s=i.next())if(t===s.value.toLowerCase())return!0}catch(e){r={error:e}}finally{try{s&&!s.done&&(o=i.return)&&o.call(i)}finally{if(r)throw r.error}}return!1}("x-amz-content-sha256",l.headers)&&this.applyChecksum&&(l.headers["x-amz-content-sha256"]=g),_=Ge(l,a,s),[4,this.getSignature(f,h,this.getSigningKey(n,r,v,c),this.createCanonicalRequest(l,_,g))];case 6:return p=m.sent(),l.headers.authorization="AWS4-HMAC-SHA256 Credential="+n.accessKeyId+"/"+h+", SignedHeaders="+it(_)+", Signature="+p,[2,l]}}))}))},t.prototype.createCanonicalRequest=function(t,n,r){var o=Object.keys(n).sort();return t.method+"\n"+this.getCanonicalPath(t)+"\n"+function(t){var n,r,o=t.query,i=void 0===o?{}:o,s=[],a={},u=function(e){if(e.toLowerCase()===qe)return"continue";s.push(e);var t=i[e];"string"==typeof t?a[e]=Xe(e)+"="+Xe(t):Array.isArray(t)&&(a[e]=t.slice(0).sort().reduce((function(t,n){return t.concat([Xe(e)+"="+Xe(n)])}),[]).join("&"))};try{for(var c=e.__values(Object.keys(i).sort()),l=c.next();!l.done;l=c.next())u(l.value)}catch(e){n={error:e}}finally{try{l&&!l.done&&(r=c.return)&&r.call(c)}finally{if(n)throw n.error}}return s.map((function(e){return a[e]})).filter((function(e){return e})).join("&")}(t)+"\n"+o.map((function(e){return e+":"+n[e]})).join("\n")+"\n\n"+o.join(";")+"\n"+r},t.prototype.createStringToSign=function(t,n,r){return e.__awaiter(this,void 0,void 0,(function(){var o,i;return e.__generator(this,(function(e){switch(e.label){case 0:return(o=new this.sha256).update(r),[4,o.digest()];case 1:return i=e.sent(),[2,"AWS4-HMAC-SHA256\n"+t+"\n"+n+"\n"+De(i)]}}))}))},t.prototype.getCanonicalPath=function(e){var t=e.path;return this.uriEscapePath?"/"+encodeURIComponent(t.replace(/^\//,"")).replace(/%2F/g,"/"):t},t.prototype.getSignature=function(t,n,r,o){return e.__awaiter(this,void 0,void 0,(function(){var i,s,a,u,c;return e.__generator(this,(function(e){switch(e.label){case 0:return[4,this.createStringToSign(t,n,o)];case 1:return i=e.sent(),u=(a=this.sha256).bind,[4,r];case 2:return(s=new(u.apply(a,[void 0,e.sent()]))).update(i),c=De,[4,s.digest()];case 3:return[2,c.apply(void 0,[e.sent()])]}}))}))},t.prototype.getSigningKey=function(t,n,r,o){return function(t,n,r,o,i){return e.__awaiter(void 0,void 0,void 0,(function(){var s,a,u,c,l,d,f,v,h;return e.__generator(this,(function(g){switch(g.label){case 0:return[4,Be(t,n.secretAccessKey,n.accessKeyId)];case 1:if(s=g.sent(),(a=r+":"+o+":"+i+":"+De(s)+":"+n.sessionToken)in $e)return[2,$e[a]];for(Fe.push(a);Fe.length>50;)delete $e[Fe.shift()];u="AWS4"+n.secretAccessKey,g.label=2;case 2:g.trys.push([2,7,8,9]),c=e.__values([r,o,i,"aws4_request"]),l=c.next(),g.label=3;case 3:return l.done?[3,6]:(d=l.value,[4,Be(t,u,d)]);case 4:u=g.sent(),g.label=5;case 5:return l=c.next(),[3,3];case 6:return[3,9];case 7:return f=g.sent(),v={error:f},[3,9];case 8:try{l&&!l.done&&(h=c.return)&&h.call(c)}finally{if(v)throw v.error}return[7];case 9:return[2,$e[a]=u]}}))}))}(this.sha256,t,r,n,o||this.service)},t}(),ot=function(e){var t=nt(e).replace(/[\-:]/g,"");return{longDate:t,shortDate:t.substr(0,8)}},it=function(e){return Object.keys(e).sort().join(";")},st=function(e){if("string"==typeof e){var t=Promise.resolve(e);return function(){return t}}return e},at=function(e){if("object"==typeof e){var t=Promise.resolve(e);return function(){return t}}return e},ut=function(t){var n,r=t.credentials?lt(t.credentials):t.credentialDefaultProvider(t),o=t.signingEscapePath,i=void 0===o||o,s=t.systemClockOffset,a=void 0===s?t.systemClockOffset||0:s,u=t.sha256;return n=t.signer?ct(t.signer):function(){return ct(t.region)().then((function(n){return e.__awaiter(void 0,void 0,void 0,(function(){return e.__generator(this,(function(e){switch(e.label){case 0:return[4,t.regionInfoProvider(n)];case 1:return[2,[e.sent()||{},n]]}}))}))})).then((function(n){var o=e.__read(n,2),s=o[0],a=o[1],c=s.signingRegion,l=s.signingService;return t.signingRegion=t.signingRegion||c||a,t.signingName=t.signingName||l||t.serviceId,new rt({credentials:r,region:t.signingRegion,service:t.signingName,sha256:u,uriEscapePath:i})}))},e.__assign(e.__assign({},t),{systemClockOffset:a,signingEscapePath:i,credentials:r,signer:n})},ct=function(e){if("object"==typeof e){var t=Promise.resolve(e);return function(){return t}}return e},lt=function(e){return"function"==typeof e?Pe(e,(function(e){return void 0!==e.expiration&&e.expiration.getTime()-Date.now()<3e5}),(function(e){return void 0!==e.expiration})):ct(e)},dt=function(e){return new Date(Date.now()+e)},ft=function(e,t){var n=Date.parse(e);return function(e,t){return Math.abs(dt(t).getTime()-e)>=3e5}(n,t)?n-Date.now():t},vt={name:"awsAuthMiddleware",tags:["SIGNATURE","AWSAUTH"],relation:"after",toMiddleware:"retryMiddleware",override:!0},ht=function(t){return{applyToStack:function(n){n.addRelativeTo(function(t){return function(n,r){return function(o){return e.__awaiter(this,void 0,void 0,(function(){var i,s,a,u,c,l,d;return e.__generator(this,(function(f){switch(f.label){case 0:return e.HttpRequest.isInstance(o.request)?[4,t.signer()]:[2,n(o)];case 1:return i=f.sent(),a=n,u=[e.__assign({},o)],d={},[4,i.sign(o.request,{signingDate:dt(t.systemClockOffset),signingRegion:r.signing_region,signingService:r.signing_service})];case 2:return[4,a.apply(void 0,[e.__assign.apply(void 0,u.concat([(d.request=f.sent(),d)]))]).catch((function(e){throw e.ServerTime&&(t.systemClockOffset=ft(e.ServerTime,t.systemClockOffset)),e}))];case 3:return s=f.sent(),c=s.response.headers,(l=c&&(c.date||c.Date))&&(t.systemClockOffset=ft(l,t.systemClockOffset)),[2,s]}}))}))}}}(t),vt)}}},gt=function(t){function n(e){var n=t.call(this)||this;return n.input=e,n}return e.__extends(n,t),n.prototype.resolveMiddleware=function(t,n,r){this.middlewareStack.use(e.getSerdePlugin(n,this.serialize,this.deserialize)),this.middlewareStack.use(ht(n));var o=t.concat(this.middlewareStack),i={logger:n.logger,clientName:"STSClient",commandName:"AssumeRoleCommand",inputFilterSensitiveLog:p.filterSensitiveLog,outputFilterSensitiveLog:y.filterSensitiveLog},s=n.requestHandler;return o.resolve((function(e){return s.handle(e.request,r||{})}),i)},n.prototype.serialize=function(t,n){return function(t,n){return e.__awaiter(void 0,void 0,void 0,(function(){var r,o;return e.__generator(this,(function(i){return r={"content-type":"application/x-www-form-urlencoded"},o=xe(e.__assign(e.__assign({},re(t,n)),{Action:"AssumeRole",Version:"2011-06-15"})),[2,Ee(n,r,"/",void 0,o)]}))}))}(t,n)},n.prototype.deserialize=function(t,n){return function(t,n){return e.__awaiter(void 0,void 0,void 0,(function(){var r,o,i;return e.__generator(this,(function(s){switch(s.label){case 0:return t.statusCode>=300?[2,G(t,n)]:[4,Ae(t.body,n)];case 1:return r=s.sent(),o=de(r.AssumeRoleResult,n),i=e.__assign({$metadata:be(t)},o),[2,Promise.resolve(i)]}}))}))}(t,n)},n}(e.Command),_t=function(t){function n(e){var n=t.call(this)||this;return n.input=e,n}return e.__extends(n,t),n.prototype.resolveMiddleware=function(t,n,r){this.middlewareStack.use(e.getSerdePlugin(n,this.serialize,this.deserialize));var o=t.concat(this.middlewareStack),i={logger:n.logger,clientName:"STSClient",commandName:"AssumeRoleWithWebIdentityCommand",inputFilterSensitiveLog:I.filterSensitiveLog,outputFilterSensitiveLog:k.filterSensitiveLog},s=n.requestHandler;return o.resolve((function(e){return s.handle(e.request,r||{})}),i)},n.prototype.serialize=function(t,n){return function(t,n){return e.__awaiter(void 0,void 0,void 0,(function(){var r,o;return e.__generator(this,(function(i){return r={"content-type":"application/x-www-form-urlencoded"},o=xe(e.__assign(e.__assign({},oe(t,n)),{Action:"AssumeRoleWithWebIdentity",Version:"2011-06-15"})),[2,Ee(n,r,"/",void 0,o)]}))}))}(t,n)},n.prototype.deserialize=function(t,n){return function(t,n){return e.__awaiter(void 0,void 0,void 0,(function(){var r,o,i;return e.__generator(this,(function(s){switch(s.label){case 0:return t.statusCode>=300?[2,X(t,n)]:[4,Ae(t.body,n)];case 1:return r=s.sent(),o=fe(r.AssumeRoleWithWebIdentityResult,n),i=e.__assign({$metadata:be(t)},o),[2,Promise.resolve(i)]}}))}))}(t,n)},n}(e.Command),pt=function(t){return"function"!=typeof t?void 0===t?"us-east-1":t:function(){return e.__awaiter(void 0,void 0,void 0,(function(){return e.__generator(this,(function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,t()];case 1:return[2,e.sent()];case 2:return e.sent(),[2,"us-east-1"];case 3:return[2]}}))}))}},mt=function(t,n){var r,o;return function(i,s){return e.__awaiter(void 0,void 0,void 0,(function(){var a,u,c,l;return e.__generator(this,(function(d){switch(d.label){case 0:return o=i,r||(a=t.logger,u=t.region,c=t.requestHandler,r=new n(e.__assign({logger:a,credentialDefaultProvider:function(){return function(){return e.__awaiter(void 0,void 0,void 0,(function(){return e.__generator(this,(function(e){return[2,o]}))}))}},region:pt(u||t.region)},c?{requestHandler:c}:{}))),[4,r.send(new gt(s))];case 1:if(!(l=d.sent().Credentials)||!l.AccessKeyId||!l.SecretAccessKey)throw new Error("Invalid response from STS.assumeRole call with role "+s.RoleArn);return[2,{accessKeyId:l.AccessKeyId,secretAccessKey:l.SecretAccessKey,sessionToken:l.SessionToken,expiration:l.Expiration}]}}))}))}},yt=function(t,n){var r;return function(o){return e.__awaiter(void 0,void 0,void 0,(function(){var i,s,a,u;return e.__generator(this,(function(c){switch(c.label){case 0:return r||(i=t.logger,s=t.region,a=t.requestHandler,r=new n(e.__assign({logger:i,region:pt(s||t.region)},a?{requestHandler:a}:{}))),[4,r.send(new _t(o))];case 1:if(!(u=c.sent().Credentials)||!u.AccessKeyId||!u.SecretAccessKey)throw new Error("Invalid response from STS.assumeRoleWithWebIdentity call with role "+o.RoleArn);return[2,{accessKeyId:u.AccessKeyId,secretAccessKey:u.SecretAccessKey,sessionToken:u.SessionToken,expiration:u.Expiration}]}}))}))}},wt=function(e){var t=e.endpoint,n=e.urlParser;if("string"==typeof t){var r=Promise.resolve(n(t));return function(){return r}}if("object"==typeof t){var o=Promise.resolve(t);return function(){return o}}return t},bt=function(t){var n;return e.__assign(e.__assign({},t),{tls:null===(n=t.tls)||void 0===n||n,endpoint:t.endpoint?wt(e.__assign(e.__assign({},t),{endpoint:t.endpoint})):function(){return function(t){return e.__awaiter(void 0,void 0,void 0,(function(){var n,r,o,i,s;return e.__generator(this,(function(e){switch(e.label){case 0:return n=t.tls,r=void 0===n||n,[4,t.region()];case 1:if(o=e.sent(),!new RegExp(/^([a-zA-Z0-9]|[a-zA-Z0-9][a-zA-Z0-9-]{0,61}[a-zA-Z0-9])$/).test(o))throw new Error("Invalid region in client config");return[4,t.regionInfoProvider(o)];case 2:if(!(i=(null!==(s=e.sent())&&void 0!==s?s:{}).hostname))throw new Error("Cannot resolve hostname from client config");return[2,t.urlParser((r?"https:":"http:")+"//"+i)]}}))}))}(t)},isCustomEndpoint:!!t.endpoint})},St={environmentVariableSelector:function(e){return e.AWS_REGION},configFileSelector:function(e){return e.region},default:function(){throw new Error("Region is missing")}},Et={preferredFile:"credentials"},At=function(e){if("string"==typeof e){var t=Promise.resolve(e);return function(){return t}}return e},xt=function(t){if(!t.region)throw new Error("Region is missing");return e.__assign(e.__assign({},t),{region:At(t.region)})},Tt=function(e,t){var n,r=t.partitionHash;return null!==(n=Object.keys(r||{}).find((function(t){return r[t].regions.includes(e)})))&&void 0!==n?n:"aws"},Rt=function(e,t){var n,r,o=t.signingService,i=t.regionHash,s=t.partitionHash;return null!==(r=null===(n=i[e])||void 0===n?void 0:n.hostname)&&void 0!==r?r:function(e,t){var n,r,o=t.signingService,i=t.partitionHash;return null!==(r=null===(n=i[Tt(e,{partitionHash:i})])||void 0===n?void 0:n.hostname)&&void 0!==r?r:"{signingService}.{region}.amazonaws.com".replace("{signingService}",o)}(e,{signingService:o,partitionHash:s}).replace("{region}",e)},It=function(t,n){var r,o,i,s,a=n.signingService,u=n.regionHash,c=n.partitionHash,l=Tt(t,{partitionHash:c}),d=null!==(o=null===(r=c[l])||void 0===r?void 0:r.endpoint)&&void 0!==o?o:t;return e.__assign(e.__assign({partition:l,signingService:a,hostname:Rt(d,{signingService:a,regionHash:u,partitionHash:c})},(null===(i=u[d])||void 0===i?void 0:i.signingRegion)&&{signingRegion:u[d].signingRegion}),(null===(s=u[d])||void 0===s?void 0:s.signingService)&&{signingService:u[d].signingService})};function kt(){return function(){var e=process.env.AWS_ACCESS_KEY_ID,t=process.env.AWS_SECRET_ACCESS_KEY,n=process.env.AWS_CREDENTIAL_EXPIRATION;return e&&t?Promise.resolve({accessKeyId:e,secretAccessKey:t,sessionToken:process.env.AWS_SESSION_TOKEN,expiration:n?new Date(n):void 0}):Promise.reject(new Ie("Unable to find environment variable credentials."))}}function Pt(t){return new Promise((function(o,i){var s,a=r.request(e.__assign(e.__assign({method:"GET"},t),{hostname:null===(s=t.hostname)||void 0===s?void 0:s.replace(/^\[(.+)\]$/,"$1")}));a.on("error",(function(e){i(Object.assign(new Re("Unable to connect to instance metadata service"),e)),a.destroy()})),a.on("timeout",(function(){i(new Re("TimeoutError from instance metadata service")),a.destroy()})),a.on("response",(function(e){var t=e.statusCode,r=void 0===t?400:t;(r<200||300<=r)&&(i(Object.assign(new Re("Error response received from instance metadata service"),{statusCode:r})),a.destroy());var s=[];e.on("data",(function(e){s.push(e)})),e.on("end",(function(){o(n.Buffer.concat(s)),a.destroy()}))})),a.end()}))}var Ct=function(e){return Boolean(e)&&"object"==typeof e&&"string"==typeof e.AccessKeyId&&"string"==typeof e.SecretAccessKey&&"string"==typeof e.Token&&"string"==typeof e.Expiration},Ot=function(e){return{accessKeyId:e.AccessKeyId,secretAccessKey:e.SecretAccessKey,sessionToken:e.Token,expiration:new Date(e.Expiration)}},zt=function(e){var t=e.maxRetries,n=void 0===t?0:t,r=e.timeout;return{maxRetries:n,timeout:void 0===r?1e3:r}},Nt=function(e,t){for(var n=e(),r=0;r<t;r++)n=n.catch(e);return n},Dt="AWS_CONTAINER_CREDENTIALS_FULL_URI",Lt="AWS_CONTAINER_CREDENTIALS_RELATIVE_URI",Ut=function(t){void 0===t&&(t={});var n=zt(t),r=n.timeout,o=n.maxRetries;return function(){return Nt((function(){return e.__awaiter(void 0,void 0,void 0,(function(){var t,n,o,i;return e.__generator(this,(function(e){switch(e.label){case 0:return[4,Ht()];case 1:return t=e.sent(),i=(o=JSON).parse,[4,qt(r,t)];case 2:if(n=i.apply(o,[e.sent()]),!Ct(n))throw new Ie("Invalid response received from instance metadata service.");return[2,Ot(n)]}}))}))}),o)}},qt=function(t,n){return e.__awaiter(void 0,void 0,void 0,(function(){return e.__generator(this,(function(r){switch(r.label){case 0:return process.env.AWS_CONTAINER_AUTHORIZATION_TOKEN&&(n.headers=e.__assign(e.__assign({},n.headers),{Authorization:process.env.AWS_CONTAINER_AUTHORIZATION_TOKEN})),[4,Pt(e.__assign(e.__assign({},n),{timeout:t}))];case 1:return[2,r.sent().toString()]}}))}))},jt={localhost:!0,"127.0.0.1":!0},Mt={"http:":!0,"https:":!0},Ht=function(){return e.__awaiter(void 0,void 0,void 0,(function(){var n;return e.__generator(this,(function(r){if(process.env[Lt])return[2,{hostname:"169.254.170.2",path:process.env[Lt]}];if(process.env[Dt]){if(!(n=t.parse(process.env[Dt])).hostname||!(n.hostname in jt))throw new Ie(n.hostname+" is not a valid container metadata service hostname",!1);if(!n.protocol||!(n.protocol in Mt))throw new Ie(n.protocol+" is not a valid container metadata service protocol",!1);return[2,e.__assign(e.__assign({},n),{port:n.port?parseInt(n.port,10):void 0})]}throw new Ie("The container metadata credential provider cannot be used unless the "+Lt+" or "+Dt+" environment variable is set",!1)}))}))},Wt=function(){return{}},Kt=function(t){void 0===t&&(t={});var n=t.filepath,r=void 0===n?process.env.AWS_SHARED_CREDENTIALS_FILE||s.join(Xt(),".aws","credentials"):n,o=t.configFilepath,i=void 0===o?process.env.AWS_CONFIG_FILE||s.join(Xt(),".aws","config"):o;return Promise.all([Gt(i).then(Bt).then(Ft).catch(Wt),Gt(r).then(Bt).catch(Wt)]).then((function(t){var n=e.__read(t,2);return{configFile:n[0],credentialsFile:n[1]}}))},$t=/^profile\s(["'])?([^\1]+)\1$/,Ft=function(t){var n,r,o={};try{for(var i=e.__values(Object.keys(t)),s=i.next();!s.done;s=i.next()){var a=s.value,u=void 0;if("default"===a)o.default=t.default;else if(u=$t.exec(a)){var c=e.__read(u,3),l=(c[0],c[1],c[2]);l&&(o[l]=t[a])}}}catch(e){n={error:e}}finally{try{s&&!s.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return o},Vt=["__proto__","profile __proto__"],Bt=function(t){var n,r,o,i={};try{for(var s=e.__values(t.split(/\r?\n/)),a=s.next();!a.done;a=s.next()){var u=a.value,c=(u=u.split(/(^|\s)[;#]/)[0]).match(/^\s*\[([^\[\]]+)]\s*$/);if(c){if(o=c[1],Vt.includes(o))throw new Error('Found invalid profile name "'+o+'"')}else if(o){var l=u.match(/^\s*(.+?)\s*=\s*(.+?)\s*$/);l&&(i[o]=i[o]||{},i[o][l[1]]=l[2])}}}catch(e){n={error:e}}finally{try{a&&!a.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}return i},Gt=function(e){return new Promise((function(t,n){o.readFile(e,"utf8",(function(e,r){e?n(e):t(r)}))}))},Xt=function(){var e=process.env,t=e.HOME,n=e.USERPROFILE,r=e.HOMEPATH,o=e.HOMEDRIVE,a=void 0===o?"C:"+s.sep:o;return t||(n||(r?""+a+r:i.homedir()))},Jt=function(t){return"function"==typeof t?function(){return e.__awaiter(void 0,void 0,void 0,(function(){return e.__generator(this,(function(e){return[2,t()]}))}))}:(n=t,function(){return Promise.resolve(n)});var n},Yt=function(t,n){var r,o=t.environmentVariableSelector,i=t.configFileSelector,s=t.default;return void 0===n&&(n={}),Pe(ke((r=o,function(){return e.__awaiter(void 0,void 0,void 0,(function(){var t;return e.__generator(this,(function(e){try{if(void 0===(t=r(process.env)))throw new Error;return[2,t]}catch(e){throw new Ie(e.message||"Cannot load config from environment variables with getter: "+r)}return[2]}))}))}),function(t,n){void 0===n&&(n={});var r=n.preferredFile,o=void 0===r?"config":r,i=e.__rest(n,["preferredFile"]);return function(){return e.__awaiter(void 0,void 0,void 0,(function(){var n,r,s,a,u,c,l,d,f,v,h;return e.__generator(this,(function(g){switch(g.label){case 0:return n=i.loadedConfig,r=void 0===n?Kt(i):n,s=i.profile,a=void 0===s?process.env.AWS_PROFILE||"default":s,[4,r];case 1:u=g.sent(),c=u.configFile,l=u.credentialsFile,d=l[a]||{},f=c[a]||{},v="config"===o?e.__assign(e.__assign({},d),f):e.__assign(e.__assign({},f),d);try{if(void 0===(h=t(v)))throw new Error;return[2,h]}catch(e){throw new Ie(e.message||"Cannot load config for profile "+a+" in SDK configuration files with getter: "+t)}return[2]}}))}))}}(i,n),Jt(s)))};var Zt,Qt=function(t){var n,r=new URL(t),o=r.hostname,i=r.pathname,s=r.port,a=r.protocol,u=r.search;return u&&(n=function(t){var n,r,o={};if(t=t.replace(/^\?/,""))try{for(var i=e.__values(t.split("&")),s=i.next();!s.done;s=i.next()){var a=s.value,u=e.__read(a.split("="),2),c=u[0],l=u[1],d=void 0===l?null:l;c=decodeURIComponent(c),d&&(d=decodeURIComponent(d)),c in o?Array.isArray(o[c])?o[c].push(d):o[c]=[o[c],d]:o[c]=d}}catch(e){n={error:e}}finally{try{s&&!s.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return o}(u)),{hostname:o,port:s?parseInt(s):void 0,protocol:a,path:i,query:n}};!function(e){e.IPv4="http://169.254.169.254",e.IPv6="http://[fd00:ec2::254]"}(Zt||(Zt={}));var en,tn={environmentVariableSelector:function(e){return e.AWS_EC2_METADATA_SERVICE_ENDPOINT},configFileSelector:function(e){return e.ec2_metadata_service_endpoint},default:void 0};!function(e){e.IPv4="IPv4",e.IPv6="IPv6"}(en||(en={}));var nn={environmentVariableSelector:function(e){return e.AWS_EC2_METADATA_SERVICE_ENDPOINT_MODE},configFileSelector:function(e){return e.ec2_metadata_service_endpoint_mode},default:en.IPv4},rn=function(){return e.__awaiter(void 0,void 0,void 0,(function(){return e.__generator(this,(function(e){return[2,Yt(tn)()]}))}))},on=function(){return e.__awaiter(void 0,void 0,void 0,(function(){var t;return e.__generator(this,(function(e){switch(e.label){case 0:return[4,Yt(nn)()];case 1:switch(t=e.sent()){case en.IPv4:return[2,Zt.IPv4];case en.IPv6:return[2,Zt.IPv6];default:throw new Error("Unsupported endpoint mode: "+t+". Select from "+Object.values(en))}}}))}))},sn="/latest/meta-data/iam/security-credentials/",an=function(t){void 0===t&&(t={});var n=!1,r=zt(t),o=r.timeout,i=r.maxRetries,s=function(t,r){return e.__awaiter(void 0,void 0,void 0,(function(){var o;return e.__generator(this,(function(i){switch(i.label){case 0:return[4,Nt((function(){return e.__awaiter(void 0,void 0,void 0,(function(){var t,o;return e.__generator(this,(function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,cn(r)];case 1:return t=e.sent(),[3,3];case 2:throw 401===(o=e.sent()).statusCode&&(n=!1),o;case 3:return[2,t]}}))}))}),t)];case 1:return o=i.sent().trim(),[2,Nt((function(){return e.__awaiter(void 0,void 0,void 0,(function(){var t,i;return e.__generator(this,(function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,ln(o,r)];case 1:return t=e.sent(),[3,3];case 2:throw 401===(i=e.sent()).statusCode&&(n=!1),i;case 3:return[2,t]}}))}))}),t)]}}))}))};return function(){return e.__awaiter(void 0,void 0,void 0,(function(){var t,r,a;return e.__generator(this,(function(u){switch(u.label){case 0:return[4,e.__awaiter(void 0,void 0,void 0,(function(){var t,n;return e.__generator(this,(function(e){switch(e.label){case 0:return t=Qt,[4,rn()];case 1:return(n=e.sent())?[3,3]:[4,on()];case 2:n=e.sent(),e.label=3;case 3:return[2,t.apply(void 0,[n])]}}))}))];case 1:return t=u.sent(),n?[2,s(i,e.__assign(e.__assign({},t),{timeout:o}))]:[3,2];case 2:r=void 0,u.label=3;case 3:return u.trys.push([3,5,,6]),[4,un(e.__assign(e.__assign({},t),{timeout:o}))];case 4:return r=u.sent().toString(),[3,6];case 5:if(400===(null==(a=u.sent())?void 0:a.statusCode))throw Object.assign(a,{message:"EC2 Metadata token request returned error"});return("TimeoutError"===a.message||[403,404,405].includes(a.statusCode))&&(n=!0),[2,s(i,e.__assign(e.__assign({},t),{timeout:o}))];case 6:return[2,s(i,e.__assign(e.__assign({},t),{headers:{"x-aws-ec2-metadata-token":r},timeout:o}))]}}))}))}},un=function(t){return e.__awaiter(void 0,void 0,void 0,(function(){return e.__generator(this,(function(n){return[2,Pt(e.__assign(e.__assign({},t),{path:"/latest/api/token",method:"PUT",headers:{"x-aws-ec2-metadata-token-ttl-seconds":"21600"}}))]}))}))},cn=function(t){return e.__awaiter(void 0,void 0,void 0,(function(){return e.__generator(this,(function(n){switch(n.label){case 0:return[4,Pt(e.__assign(e.__assign({},t),{path:sn}))];case 1:return[2,n.sent().toString()]}}))}))},ln=function(t,n){return e.__awaiter(void 0,void 0,void 0,(function(){var r,o,i;return e.__generator(this,(function(s){switch(s.label){case 0:return i=(o=JSON).parse,[4,Pt(e.__assign(e.__assign({},n),{path:sn+t}))];case 1:if(r=i.apply(o,[s.sent().toString()]),!Ct(r))throw new Ie("Invalid response received from instance metadata service.");return[2,Ot(r)]}}))}))},dn="3.30.0",fn=function(e,t,r){if(void 0===t&&(t=0),void 0===r&&(r=e.byteLength-t),!Ye(e))throw new TypeError('The "input" argument must be ArrayBuffer. Received type '+typeof e+" ("+e+")");return n.Buffer.from(e,t,r)},vn=function(e,t){if("string"!=typeof e)throw new TypeError('The "input" argument must be of type string. Received type '+typeof e+" ("+e+")");return t?n.Buffer.from(e,t):n.Buffer.from(e)},hn=function(){function e(e,t){this.hash=t?a.createHmac(e,gn(t)):a.createHash(e)}return e.prototype.update=function(e,t){this.hash.update(gn(e,t))},e.prototype.digest=function(){return Promise.resolve(this.hash.digest())},e}();function gn(e,t){return n.Buffer.isBuffer(e)?e:"string"==typeof e?vn(e,t):ArrayBuffer.isView(e)?fn(e.buffer,e.byteOffset,e.byteLength):fn(e)}var _n={name:"retryMiddleware",tags:["RETRY"],step:"finalizeRequest",priority:"high",override:!0},pn=function(t){return{applyToStack:function(n){n.add(function(t){return function(n,r){return function(o){return e.__awaiter(void 0,void 0,void 0,(function(){var i;return e.__generator(this,(function(s){switch(s.label){case 0:return[4,t.retryStrategy()];case 1:return(null==(i=s.sent())?void 0:i.mode)&&(r.userAgent=e.__spreadArray(e.__spreadArray([],e.__read(r.userAgent||[]),!1),[["cfg/retry-mode",i.mode]],!1)),[2,i.retry(n,o)]}}))}))}}}(t),_n)}}},mn=["AuthFailure","InvalidSignatureException","RequestExpired","RequestInTheFuture","RequestTimeTooSkewed","SignatureDoesNotMatch"],yn=["BandwidthLimitExceeded","EC2ThrottledException","LimitExceededException","PriorRequestNotComplete","ProvisionedThroughputExceededException","RequestLimitExceeded","RequestThrottled","RequestThrottledException","SlowDown","ThrottledException","Throttling","ThrottlingException","TooManyRequestsException","TransactionInProgressException"],wn=["AbortError","TimeoutError","RequestTimeout","RequestTimeoutException"],bn=[500,502,503,504],Sn=function(e){var t,n;return 429===(null===(t=e.$metadata)||void 0===t?void 0:t.httpStatusCode)||yn.includes(e.name)||1==(null===(n=e.$retryable)||void 0===n?void 0:n.throttling)};const En=new Uint8Array(256);let An=En.length;function xn(){return An>En.length-16&&(K.default.randomFillSync(En),An=0),En.slice(An,An+=16)}var Tn=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;const Rn=[];for(let e=0;e<256;++e)Rn.push((e+256).toString(16).substr(1));function In(e,t=0){const n=(Rn[e[t+0]]+Rn[e[t+1]]+Rn[e[t+2]]+Rn[e[t+3]]+"-"+Rn[e[t+4]]+Rn[e[t+5]]+"-"+Rn[e[t+6]]+Rn[e[t+7]]+"-"+Rn[e[t+8]]+Rn[e[t+9]]+"-"+Rn[e[t+10]]+Rn[e[t+11]]+Rn[e[t+12]]+Rn[e[t+13]]+Rn[e[t+14]]+Rn[e[t+15]]).toLowerCase();if(!function(e){return"string"==typeof e&&Tn.test(e)}(n))throw TypeError("Stringified UUID is invalid");return n}function kn(e,t,n){const r=(e=e||{}).random||(e.rng||xn)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,t){n=n||0;for(let e=0;e<16;++e)t[n+e]=r[e];return t}return In(r)}var Pn;!function(e){e.STANDARD="standard",e.ADAPTIVE="adaptive"}(Pn||(Pn={}));var Cn=Pn.STANDARD,On=function(e,t){return Math.floor(Math.min(2e4,Math.random()*Math.pow(2,t)*e))},zn=function(e){return!!e&&(function(e){return void 0!==e.$retryable}(e)||function(e){return mn.includes(e.name)}(e)||Sn(e)||function(e){var t;return wn.includes(e.name)||bn.includes((null===(t=e.$metadata)||void 0===t?void 0:t.httpStatusCode)||0)}(e))},Nn=function(){function t(e,t){var n,r,o;this.maxAttemptsProvider=e,this.mode=Pn.STANDARD,this.retryDecider=null!==(n=null==t?void 0:t.retryDecider)&&void 0!==n?n:zn,this.delayDecider=null!==(r=null==t?void 0:t.delayDecider)&&void 0!==r?r:On,this.retryQuota=null!==(o=null==t?void 0:t.retryQuota)&&void 0!==o?o:function(e,t){var n,r,o,i=e,s=null!==(n=null==t?void 0:t.noRetryIncrement)&&void 0!==n?n:1,a=null!==(r=null==t?void 0:t.retryCost)&&void 0!==r?r:5,u=null!==(o=null==t?void 0:t.timeoutRetryCost)&&void 0!==o?o:10,c=e,l=function(e){return"TimeoutError"===e.name?u:a},d=function(e){return l(e)<=c};return Object.freeze({hasRetryTokens:d,retrieveRetryTokens:function(e){if(!d(e))throw new Error("No retry token available");var t=l(e);return c-=t,t},releaseRetryTokens:function(e){c+=null!=e?e:s,c=Math.min(c,i)}})}(500)}return t.prototype.shouldRetry=function(e,t,n){return t<n&&this.retryDecider(e)&&this.retryQuota.hasRetryTokens(e)},t.prototype.getMaxAttempts=function(){return e.__awaiter(this,void 0,void 0,(function(){var t;return e.__generator(this,(function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,this.maxAttemptsProvider()];case 1:return t=e.sent(),[3,3];case 2:return e.sent(),t=3,[3,3];case 3:return[2,t]}}))}))},t.prototype.retry=function(t,n,r){return e.__awaiter(this,void 0,void 0,(function(){var o,i,s,a,u,c,l,d;return e.__generator(this,(function(f){switch(f.label){case 0:return i=0,s=0,[4,this.getMaxAttempts()];case 1:a=f.sent(),u=n.request,e.HttpRequest.isInstance(u)&&(u.headers["amz-sdk-invocation-id"]=kn()),c=function(){var c,d,f,v,h,g;return e.__generator(this,(function(_){switch(_.label){case 0:return _.trys.push([0,4,,7]),e.HttpRequest.isInstance(u)&&(u.headers["amz-sdk-request"]="attempt="+(i+1)+"; max="+a),(null==r?void 0:r.beforeRequest)?[4,r.beforeRequest()]:[3,2];case 1:_.sent(),_.label=2;case 2:return[4,t(n)];case 3:return c=_.sent(),d=c.response,f=c.output,(null==r?void 0:r.afterRequest)&&r.afterRequest(d),l.retryQuota.releaseRetryTokens(o),f.$metadata.attempts=i+1,f.$metadata.totalRetryDelay=s,[2,{value:{response:d,output:f}}];case 4:return v=_.sent(),h=Dn(v),i++,l.shouldRetry(h,i,a)?(o=l.retryQuota.retrieveRetryTokens(h),g=l.delayDecider(Sn(h)?500:100,i),s+=g,[4,new Promise((function(e){return setTimeout(e,g)}))]):[3,6];case 5:return _.sent(),[2,"continue"];case 6:throw h.$metadata||(h.$metadata={}),h.$metadata.attempts=i,h.$metadata.totalRetryDelay=s,h;case 7:return[2]}}))},l=this,f.label=2;case 2:return[5,c()];case 3:return"object"==typeof(d=f.sent())?[2,d.value]:[3,2];case 4:return[2]}}))}))},t}(),Dn=function(e){return e instanceof Error?e:e instanceof Object?Object.assign(new Error,e):"string"==typeof e?new Error(e):new Error("AWS SDK error wrapper for "+e)},Ln=function(){function t(e){var t,n,r,o,i;this.currentCapacity=0,this.enabled=!1,this.lastMaxRate=0,this.measuredTxRate=0,this.requestCount=0,this.lastTimestamp=0,this.timeWindow=0,this.beta=null!==(t=null==e?void 0:e.beta)&&void 0!==t?t:.7,this.minCapacity=null!==(n=null==e?void 0:e.minCapacity)&&void 0!==n?n:1,this.minFillRate=null!==(r=null==e?void 0:e.minFillRate)&&void 0!==r?r:.5,this.scaleConstant=null!==(o=null==e?void 0:e.scaleConstant)&&void 0!==o?o:.4,this.smooth=null!==(i=null==e?void 0:e.smooth)&&void 0!==i?i:.8;var s=this.getCurrentTimeInSeconds();this.lastThrottleTime=s,this.lastTxRateBucket=Math.floor(this.getCurrentTimeInSeconds()),this.fillRate=this.minFillRate,this.maxCapacity=this.minCapacity}return t.prototype.getCurrentTimeInSeconds=function(){return Date.now()/1e3},t.prototype.getSendToken=function(){return e.__awaiter(this,void 0,void 0,(function(){return e.__generator(this,(function(e){return[2,this.acquireTokenBucket(1)]}))}))},t.prototype.acquireTokenBucket=function(t){return e.__awaiter(this,void 0,void 0,(function(){var n;return e.__generator(this,(function(e){switch(e.label){case 0:return this.enabled?(this.refillTokenBucket(),t>this.currentCapacity?(n=(t-this.currentCapacity)/this.fillRate*1e3,[4,new Promise((function(e){return setTimeout(e,n)}))]):[3,2]):[2];case 1:e.sent(),e.label=2;case 2:return this.currentCapacity=this.currentCapacity-t,[2]}}))}))},t.prototype.refillTokenBucket=function(){var e=this.getCurrentTimeInSeconds();if(this.lastTimestamp){var t=(e-this.lastTimestamp)*this.fillRate;this.currentCapacity=Math.min(this.maxCapacity,this.currentCapacity+t),this.lastTimestamp=e}else this.lastTimestamp=e},t.prototype.updateClientSendingRate=function(e){var t;if(this.updateMeasuredRate(),Sn(e)){var n=this.enabled?Math.min(this.measuredTxRate,this.fillRate):this.measuredTxRate;this.lastMaxRate=n,this.calculateTimeWindow(),this.lastThrottleTime=this.getCurrentTimeInSeconds(),t=this.cubicThrottle(n),this.enableTokenBucket()}else this.calculateTimeWindow(),t=this.cubicSuccess(this.getCurrentTimeInSeconds());var r=Math.min(t,2*this.measuredTxRate);this.updateTokenBucketRate(r)},t.prototype.calculateTimeWindow=function(){this.timeWindow=this.getPrecise(Math.pow(this.lastMaxRate*(1-this.beta)/this.scaleConstant,1/3))},t.prototype.cubicThrottle=function(e){return this.getPrecise(e*this.beta)},t.prototype.cubicSuccess=function(e){return this.getPrecise(this.scaleConstant*Math.pow(e-this.lastThrottleTime-this.timeWindow,3)+this.lastMaxRate)},t.prototype.enableTokenBucket=function(){this.enabled=!0},t.prototype.updateTokenBucketRate=function(e){this.refillTokenBucket(),this.fillRate=Math.max(e,this.minFillRate),this.maxCapacity=Math.max(e,this.minCapacity),this.currentCapacity=Math.min(this.currentCapacity,this.maxCapacity)},t.prototype.updateMeasuredRate=function(){var e=this.getCurrentTimeInSeconds(),t=Math.floor(2*e)/2;if(this.requestCount++,t>this.lastTxRateBucket){var n=this.requestCount/(t-this.lastTxRateBucket);this.measuredTxRate=this.getPrecise(n*this.smooth+this.measuredTxRate*(1-this.smooth)),this.requestCount=0,this.lastTxRateBucket=t}},t.prototype.getPrecise=function(e){return parseFloat(e.toFixed(8))},t}(),Un=function(t){function n(n,r){var o=this,i=null!=r?r:{},s=i.rateLimiter,a=e.__rest(i,["rateLimiter"]);return(o=t.call(this,n,a)||this).rateLimiter=null!=s?s:new Ln,o.mode=Pn.ADAPTIVE,o}return e.__extends(n,t),n.prototype.retry=function(n,r){return e.__awaiter(this,void 0,void 0,(function(){var o=this;return e.__generator(this,(function(i){return[2,t.prototype.retry.call(this,n,r,{beforeRequest:function(){return e.__awaiter(o,void 0,void 0,(function(){return e.__generator(this,(function(e){return[2,this.rateLimiter.getSendToken()]}))}))},afterRequest:function(e){o.rateLimiter.updateClientSendingRate(e)}})]}))}))},n}(Nn),qn={environmentVariableSelector:function(e){var t=e.AWS_MAX_ATTEMPTS;if(t){var n=parseInt(t);if(Number.isNaN(n))throw new Error('Environment variable AWS_MAX_ATTEMPTS mast be a number, got "'+t+'"');return n}},configFileSelector:function(e){var t=e.max_attempts;if(t){var n=parseInt(t);if(Number.isNaN(n))throw new Error('Shared config file entry max_attempts mast be a number, got "'+t+'"');return n}},default:3},jn=function(t){var n=Hn(t.maxAttempts);return e.__assign(e.__assign({},t),{maxAttempts:n,retryStrategy:function(){return e.__awaiter(void 0,void 0,void 0,(function(){return e.__generator(this,(function(e){switch(e.label){case 0:return t.retryStrategy?[2,t.retryStrategy]:[4,Mn(t.retryMode)];case 1:return e.sent()===Pn.ADAPTIVE?[2,new Un(n)]:[2,new Nn(n)]}}))}))}})},Mn=function(t){return e.__awaiter(void 0,void 0,void 0,(function(){return e.__generator(this,(function(e){switch(e.label){case 0:return"string"==typeof t?[2,t]:[4,t()];case 1:return[2,e.sent()]}}))}))},Hn=function(e){if(void 0===e&&(e=3),"number"==typeof e){var t=Promise.resolve(e);return function(){return t}}return e},Wn={environmentVariableSelector:function(e){return e.AWS_RETRY_MODE},configFileSelector:function(e){return e.retry_mode},default:Cn};var Kn=["ECONNRESET","EPIPE","ETIMEDOUT"],$n=function(t){var n,r,o={};try{for(var i=e.__values(Object.keys(t)),s=i.next();!s.done;s=i.next()){var a=s.value,u=t[a];o[a]=Array.isArray(u)?u.join(","):u}}catch(e){n={error:e}}finally{try{s&&!s.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return o};function Fn(e,t){t instanceof c.Readable?t.pipe(e):t?e.end(Buffer.from(t)):e.end()}var Vn=function(){function t(e){var t=void 0===e?{}:e,n=t.connectionTimeout,o=t.socketTimeout,i=t.httpAgent,s=t.httpsAgent;this.metadata={handlerProtocol:"http/1.1"},this.connectionTimeout=n,this.socketTimeout=o;this.httpAgent=i||new r.Agent({keepAlive:true,maxSockets:50}),this.httpsAgent=s||new u.Agent({keepAlive:true,maxSockets:50})}return t.prototype.destroy=function(){this.httpAgent.destroy(),this.httpsAgent.destroy()},t.prototype.handle=function(t,n){var o=this,i=(void 0===n?{}:n).abortSignal;return new Promise((function(n,s){if(null==i?void 0:i.aborted){var a=new Error("Request aborted");return a.name="AbortError",void s(a)}var c="https:"===t.protocol,l=function(t){var n,r,o=[];try{for(var i=e.__values(Object.keys(t).sort()),s=i.next();!s.done;s=i.next()){var a=s.value,u=t[a];if(a=Xe(a),Array.isArray(u))for(var c=0,l=u.length;c<l;c++)o.push(a+"="+Xe(u[c]));else{var d=a;(u||"string"==typeof u)&&(d+="="+Xe(u)),o.push(d)}}}catch(e){n={error:e}}finally{try{s&&!s.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return o.join("&")}(t.query||{}),d={headers:t.headers,host:t.hostname,method:t.method,path:l?t.path+"?"+l:t.path,port:t.port,agent:c?o.httpsAgent:o.httpAgent},f=(c?u.request:r.request)(d,(function(t){var r=new e.HttpResponse({statusCode:t.statusCode||-1,headers:$n(t.headers),body:t});n({response:r})}));f.on("error",(function(e){Kn.includes(e.code)?s(Object.assign(e,{name:"TimeoutError"})):s(e)})),function(e,t,n){void 0===n&&(n=0),n&&e.on("socket",(function(r){if(r.connecting){var o=setTimeout((function(){e.destroy(),t(Object.assign(new Error("Socket timed out without establishing a connection within "+n+" ms"),{name:"TimeoutError"}))}),n);r.on("connect",(function(){clearTimeout(o)}))}}))}(f,s,o.connectionTimeout),function(e,t,n){void 0===n&&(n=0),e.setTimeout(n,(function(){e.destroy(),t(Object.assign(new Error("Connection timed out after "+n+" ms"),{name:"TimeoutError"}))}))}(f,s,o.socketTimeout),i&&(i.onabort=function(){f.abort();var e=new Error("Request aborted");e.name="AbortError",s(e)}),function(e,t){"100-continue"===(t.headers.Expect||t.headers.expect)?e.on("continue",(function(){Fn(e,t.body)})):Fn(e,t.body)}(f,t)}))},t}(),Bn=function(t){function n(){var e=null!==t&&t.apply(this,arguments)||this;return e.bufferedBytes=[],e}return e.__extends(n,t),n.prototype._write=function(e,t,n){this.bufferedBytes.push(e),n()},n}(c.Writable),Gn=function(e){return new Promise((function(t,n){var r=new Bn;e.pipe(r),e.on("error",(function(e){r.end(),n(e)})),r.on("error",n),r.on("finish",(function(){var e=new Uint8Array(Buffer.concat(this.bufferedBytes));t(e)}))}))};function Xn(e){var t=vn(e,"base64");return new Uint8Array(t.buffer,t.byteOffset,t.byteLength)}function Jn(e){return fn(e.buffer,e.byteOffset,e.byteLength).toString("base64")}function Yn(e){return e?"string"==typeof e?Buffer.from(e).length:"number"==typeof e.byteLength?e.byteLength:"number"==typeof e.size?e.size:"string"==typeof e.path?o.lstatSync(e.path).size:void 0:0}var Zn=function(t){var n=t.serviceId,r=t.clientVersion,o=[["aws-sdk-js",r],["os/"+i.platform(),i.release()],["lang/js"],["md/nodejs",""+l.versions.node]];n&&o.push(["api/"+n,r]),l.env.AWS_EXECUTION_ENV&&o.push(["exec-env/"+l.env.AWS_EXECUTION_ENV]);var s=Yt({environmentVariableSelector:function(e){return e.AWS_SDK_UA_APP_ID},configFileSelector:function(e){return e["sdk-ua-app-id"]},default:void 0})(),a=void 0;return function(){return e.__awaiter(void 0,void 0,void 0,(function(){var t;return e.__generator(this,(function(n){switch(n.label){case 0:return a?[3,2]:[4,s];case 1:t=n.sent(),a=t?e.__spreadArray(e.__spreadArray([],e.__read(o),!1),[["app/"+t]],!1):e.__spreadArray([],e.__read(o),!1),n.label=2;case 2:return[2,a]}}))}))}},Qn=function(e){var t=vn(e,"utf8");return new Uint8Array(t.buffer,t.byteOffset,t.byteLength/Uint8Array.BYTES_PER_ELEMENT)},er=function(e){return fn(e.buffer,e.byteOffset,e.byteLength).toString("utf8")},tr={"ap-southeast-1":{hostname:"portal.sso.ap-southeast-1.amazonaws.com",signingRegion:"ap-southeast-1"},"ap-southeast-2":{hostname:"portal.sso.ap-southeast-2.amazonaws.com",signingRegion:"ap-southeast-2"},"ca-central-1":{hostname:"portal.sso.ca-central-1.amazonaws.com",signingRegion:"ca-central-1"},"eu-central-1":{hostname:"portal.sso.eu-central-1.amazonaws.com",signingRegion:"eu-central-1"},"eu-west-1":{hostname:"portal.sso.eu-west-1.amazonaws.com",signingRegion:"eu-west-1"},"eu-west-2":{hostname:"portal.sso.eu-west-2.amazonaws.com",signingRegion:"eu-west-2"},"us-east-1":{hostname:"portal.sso.us-east-1.amazonaws.com",signingRegion:"us-east-1"},"us-east-2":{hostname:"portal.sso.us-east-2.amazonaws.com",signingRegion:"us-east-2"},"us-west-2":{hostname:"portal.sso.us-west-2.amazonaws.com",signingRegion:"us-west-2"}},nr={aws:{regions:["af-south-1","ap-east-1","ap-northeast-1","ap-northeast-2","ap-northeast-3","ap-south-1","ap-southeast-1","ap-southeast-2","ca-central-1","eu-central-1","eu-north-1","eu-south-1","eu-west-1","eu-west-2","eu-west-3","me-south-1","sa-east-1","us-east-1","us-east-2","us-west-1","us-west-2"],hostname:"portal.sso.{region}.amazonaws.com"},"aws-cn":{regions:["cn-north-1","cn-northwest-1"],hostname:"portal.sso.{region}.amazonaws.com.cn"},"aws-iso":{regions:["us-iso-east-1"],hostname:"portal.sso.{region}.c2s.ic.gov"},"aws-iso-b":{regions:["us-isob-east-1"],hostname:"portal.sso.{region}.sc2s.sgov.gov"},"aws-us-gov":{regions:["us-gov-east-1","us-gov-west-1"],hostname:"portal.sso.{region}.amazonaws.com"}},rr=function(t,n){return e.__awaiter(void 0,void 0,void 0,(function(){return e.__generator(this,(function(r){return[2,It(t,e.__assign(e.__assign({},n),{signingService:"awsssoportal",regionHash:tr,partitionHash:nr}))]}))}))},or=function(t){var n,r,o,i,s,a,u,c,l,d,f,v;B(process.version);var h=function(e){var t,n,r,o,i;return{apiVersion:"2019-06-10",disableHostPrefix:null!==(t=null==e?void 0:e.disableHostPrefix)&&void 0!==t&&t,logger:null!==(n=null==e?void 0:e.logger)&&void 0!==n?n:{},regionInfoProvider:null!==(r=null==e?void 0:e.regionInfoProvider)&&void 0!==r?r:rr,serviceId:null!==(o=null==e?void 0:e.serviceId)&&void 0!==o?o:"SSO",urlParser:null!==(i=null==e?void 0:e.urlParser)&&void 0!==i?i:Qt}}(t);return e.__assign(e.__assign(e.__assign({},h),t),{runtime:"node",base64Decoder:null!==(n=null==t?void 0:t.base64Decoder)&&void 0!==n?n:Xn,base64Encoder:null!==(r=null==t?void 0:t.base64Encoder)&&void 0!==r?r:Jn,bodyLengthChecker:null!==(o=null==t?void 0:t.bodyLengthChecker)&&void 0!==o?o:Yn,defaultUserAgentProvider:null!==(i=null==t?void 0:t.defaultUserAgentProvider)&&void 0!==i?i:Zn({serviceId:h.serviceId,clientVersion:dn}),maxAttempts:null!==(s=null==t?void 0:t.maxAttempts)&&void 0!==s?s:Yt(qn),region:null!==(a=null==t?void 0:t.region)&&void 0!==a?a:Yt(St,Et),requestHandler:null!==(u=null==t?void 0:t.requestHandler)&&void 0!==u?u:new Vn,retryMode:null!==(c=null==t?void 0:t.retryMode)&&void 0!==c?c:Yt(Wn),sha256:null!==(l=null==t?void 0:t.sha256)&&void 0!==l?l:hn.bind(null,"sha256"),streamCollector:null!==(d=null==t?void 0:t.streamCollector)&&void 0!==d?d:Gn,utf8Decoder:null!==(f=null==t?void 0:t.utf8Decoder)&&void 0!==f?f:Qn,utf8Encoder:null!==(v=null==t?void 0:t.utf8Encoder)&&void 0!==v?v:er})};var ir={step:"build",tags:["SET_CONTENT_LENGTH","CONTENT_LENGTH"],name:"contentLengthMiddleware",override:!0},sr=function(t){return{applyToStack:function(n){n.add(function(t){var n=this;return function(r){return function(o){return e.__awaiter(n,void 0,void 0,(function(){var n,i,s,a,u;return e.__generator(this,(function(c){return n=o.request,e.HttpRequest.isInstance(n)&&(i=n.body,s=n.headers,i&&-1===Object.keys(s).map((function(e){return e.toLowerCase()})).indexOf("content-length")&&void 0!==(a=t(i))&&(n.headers=e.__assign(e.__assign({},n.headers),((u={})["content-length"]=String(a),u)))),[2,r(e.__assign(e.__assign({},o),{request:n}))]}))}))}}}(t.bodyLengthChecker),ir)}}};var ar={name:"hostHeaderMiddleware",step:"build",priority:"low",tags:["HOST"],override:!0},ur=function(t){return{applyToStack:function(n){n.add(function(t){return function(n){return function(r){return e.__awaiter(void 0,void 0,void 0,(function(){var o,i;return e.__generator(this,(function(s){return e.HttpRequest.isInstance(r.request)?(o=r.request,(void 0===(i=(t.requestHandler.metadata||{}).handlerProtocol)?"":i).indexOf("h2")>=0&&!o.headers[":authority"]?(delete o.headers.host,o.headers[":authority"]=""):o.headers.host||(o.headers.host=o.hostname),[2,n(r)]):[2,n(r)]}))}))}}}(t),ar)}}},cr={name:"loggerMiddleware",tags:["LOGGER"],step:"initialize",override:!0},lr=function(t){return{applyToStack:function(t){t.add((function(t,n){return function(r){return e.__awaiter(void 0,void 0,void 0,(function(){var o,i,s,a,u,c,l,d,f;return e.__generator(this,(function(v){switch(v.label){case 0:return o=n.clientName,i=n.commandName,s=n.inputFilterSensitiveLog,a=n.logger,u=n.outputFilterSensitiveLog,[4,t(r)];case 1:return c=v.sent(),a?("function"==typeof a.info&&(l=c.output,d=l.$metadata,f=e.__rest(l,["$metadata"]),a.info({clientName:o,commandName:i,input:s(r.input),output:u(f),metadata:d})),[2,c]):[2,c]}}))}))}}),cr)}}};function dr(t){return e.__assign(e.__assign({},t),{customUserAgent:"string"==typeof t.customUserAgent?[[t.customUserAgent]]:t.customUserAgent})}var fr,vr,hr,gr,_r,pr,mr,yr,wr,br,Sr,Er,Ar,xr,Tr=/[^\!\#\$\%\&\'\*\+\-\.\^\_\`\|\~\d\w]/g,Rr=function(t){var n=e.__read(t,2),r=n[0],o=n[1],i=r.indexOf("/"),s=r.substring(0,i),a=r.substring(i+1);return"api"===s&&(a=a.toLowerCase()),[s,a,o].filter((function(e){return e&&e.length>0})).map((function(e){return null==e?void 0:e.replace(Tr,"_")})).join("/")},Ir={name:"getUserAgentMiddleware",step:"build",priority:"low",tags:["SET_USER_AGENT","USER_AGENT"],override:!0},kr=function(t){return{applyToStack:function(n){var r;n.add((r=t,function(t,n){return function(o){return e.__awaiter(void 0,void 0,void 0,(function(){var i,s,a,u,c,l,d,f,v;return e.__generator(this,(function(h){switch(h.label){case 0:return i=o.request,e.HttpRequest.isInstance(i)?(s=i.headers,a=(null===(f=null==n?void 0:n.userAgent)||void 0===f?void 0:f.map(Rr))||[],[4,r.defaultUserAgentProvider()]):[2,t(o)];case 1:return u=h.sent().map(Rr),c=(null===(v=null==r?void 0:r.customUserAgent)||void 0===v?void 0:v.map(Rr))||[],l=e.__spreadArray(e.__spreadArray(e.__spreadArray([],e.__read(u),!1),e.__read(a),!1),e.__read(c),!1).join(" "),d=e.__spreadArray(e.__spreadArray([],e.__read(u.filter((function(e){return e.startsWith("aws-sdk-")}))),!1),e.__read(c),!1).join(" "),"browser"!==r.runtime?(d&&(s["x-amz-user-agent"]=s["x-amz-user-agent"]?s["user-agent"]+" "+d:d),s["user-agent"]=l):s["x-amz-user-agent"]=l,[2,t(e.__assign(e.__assign({},o),{request:i}))]}}))}))}}),Ir)}}},Pr=function(t){function n(e){var n=this,r=or(e),o=xt(r),i=bt(o),s=dr(jn(i));return(n=t.call(this,s)||this).config=s,n.middlewareStack.use(pn(n.config)),n.middlewareStack.use(sr(n.config)),n.middlewareStack.use(ur(n.config)),n.middlewareStack.use(lr(n.config)),n.middlewareStack.use(kr(n.config)),n}return e.__extends(n,t),n.prototype.destroy=function(){t.prototype.destroy.call(this)},n}(e.Client);!function(t){t.filterSensitiveLog=function(t){return e.__assign({},t)}}(fr||(fr={})),function(t){t.filterSensitiveLog=function(t){return e.__assign(e.__assign({},t),t.accessToken&&{accessToken:e.SENSITIVE_STRING})}}(vr||(vr={})),function(t){t.filterSensitiveLog=function(t){return e.__assign(e.__assign(e.__assign({},t),t.secretAccessKey&&{secretAccessKey:e.SENSITIVE_STRING}),t.sessionToken&&{sessionToken:e.SENSITIVE_STRING})}}(hr||(hr={})),function(t){t.filterSensitiveLog=function(t){return e.__assign(e.__assign({},t),t.roleCredentials&&{roleCredentials:hr.filterSensitiveLog(t.roleCredentials)})}}(gr||(gr={})),function(t){t.filterSensitiveLog=function(t){return e.__assign({},t)}}(_r||(_r={})),function(t){t.filterSensitiveLog=function(t){return e.__assign({},t)}}(pr||(pr={})),function(t){t.filterSensitiveLog=function(t){return e.__assign({},t)}}(mr||(mr={})),function(t){t.filterSensitiveLog=function(t){return e.__assign({},t)}}(yr||(yr={})),function(t){t.filterSensitiveLog=function(t){return e.__assign(e.__assign({},t),t.accessToken&&{accessToken:e.SENSITIVE_STRING})}}(wr||(wr={})),function(t){t.filterSensitiveLog=function(t){return e.__assign({},t)}}(br||(br={})),function(t){t.filterSensitiveLog=function(t){return e.__assign({},t)}}(Sr||(Sr={})),function(t){t.filterSensitiveLog=function(t){return e.__assign(e.__assign({},t),t.accessToken&&{accessToken:e.SENSITIVE_STRING})}}(Er||(Er={})),function(t){t.filterSensitiveLog=function(t){return e.__assign({},t)}}(Ar||(Ar={})),function(t){t.filterSensitiveLog=function(t){return e.__assign(e.__assign({},t),t.accessToken&&{accessToken:e.SENSITIVE_STRING})}}(xr||(xr={}));var Cr=function(t,n){return e.__awaiter(void 0,void 0,void 0,(function(){var r,o,i,s,a,u,c,l,d,f,v;return e.__generator(this,(function(h){switch(h.label){case 0:return o=[e.__assign({},t)],v={},[4,Mr(t.body,n)];case 1:switch(r=e.__assign.apply(void 0,o.concat([(v.body=h.sent(),v)])),s="UnknownError",s=Hr(t,r.body),s){case"InvalidRequestException":case"com.amazonaws.sso#InvalidRequestException":return[3,2];case"ResourceNotFoundException":case"com.amazonaws.sso#ResourceNotFoundException":return[3,4];case"TooManyRequestsException":case"com.amazonaws.sso#TooManyRequestsException":return[3,6];case"UnauthorizedException":case"com.amazonaws.sso#UnauthorizedException":return[3,8]}return[3,10];case 2:return a=[{}],[4,Or(r,n)];case 3:return i=e.__assign.apply(void 0,[e.__assign.apply(void 0,a.concat([h.sent()])),{name:s,$metadata:Ur(t)}]),[3,11];case 4:return u=[{}],[4,zr(r,n)];case 5:return i=e.__assign.apply(void 0,[e.__assign.apply(void 0,u.concat([h.sent()])),{name:s,$metadata:Ur(t)}]),[3,11];case 6:return c=[{}],[4,Nr(r,n)];case 7:return i=e.__assign.apply(void 0,[e.__assign.apply(void 0,c.concat([h.sent()])),{name:s,$metadata:Ur(t)}]),[3,11];case 8:return l=[{}],[4,Dr(r,n)];case 9:return i=e.__assign.apply(void 0,[e.__assign.apply(void 0,l.concat([h.sent()])),{name:s,$metadata:Ur(t)}]),[3,11];case 10:d=r.body,s=d.code||d.Code||s,i=e.__assign(e.__assign({},d),{name:""+s,message:d.message||d.Message||s,$fault:"client",$metadata:Ur(t)}),h.label=11;case 11:return f=i.message||i.Message||s,i.message=f,delete i.Message,[2,Promise.reject(Object.assign(new Error(f),i))]}}))}))},Or=function(t,n){return e.__awaiter(void 0,void 0,void 0,(function(){var n,r;return e.__generator(this,(function(o){return n={name:"InvalidRequestException",$fault:"client",$metadata:Ur(t),message:void 0},void 0!==(r=t.body).message&&null!==r.message&&(n.message=e.expectString(r.message)),[2,n]}))}))},zr=function(t,n){return e.__awaiter(void 0,void 0,void 0,(function(){var n,r;return e.__generator(this,(function(o){return n={name:"ResourceNotFoundException",$fault:"client",$metadata:Ur(t),message:void 0},void 0!==(r=t.body).message&&null!==r.message&&(n.message=e.expectString(r.message)),[2,n]}))}))},Nr=function(t,n){return e.__awaiter(void 0,void 0,void 0,(function(){var n,r;return e.__generator(this,(function(o){return n={name:"TooManyRequestsException",$fault:"client",$metadata:Ur(t),message:void 0},void 0!==(r=t.body).message&&null!==r.message&&(n.message=e.expectString(r.message)),[2,n]}))}))},Dr=function(t,n){return e.__awaiter(void 0,void 0,void 0,(function(){var n,r;return e.__generator(this,(function(o){return n={name:"UnauthorizedException",$fault:"client",$metadata:Ur(t),message:void 0},void 0!==(r=t.body).message&&null!==r.message&&(n.message=e.expectString(r.message)),[2,n]}))}))},Lr=function(t,n){return{accessKeyId:e.expectString(t.accessKeyId),expiration:e.expectLong(t.expiration),secretAccessKey:e.expectString(t.secretAccessKey),sessionToken:e.expectString(t.sessionToken)}},Ur=function(e){var t;return{httpStatusCode:e.statusCode,requestId:null!==(t=e.headers["x-amzn-requestid"])&&void 0!==t?t:e.headers["x-amzn-request-id"],extendedRequestId:e.headers["x-amz-id-2"],cfId:e.headers["x-amz-cf-id"]}},qr=function(e,t){return function(e,t){return void 0===e&&(e=new Uint8Array),e instanceof Uint8Array?Promise.resolve(e):t.streamCollector(e)||Promise.resolve(new Uint8Array)}(e,t).then((function(e){return t.utf8Encoder(e)}))},jr=function(e){return!(null==e||""===e||Object.getOwnPropertyNames(e).includes("length")&&0==e.length||Object.getOwnPropertyNames(e).includes("size")&&0==e.size)},Mr=function(e,t){return qr(e,t).then((function(e){return e.length?JSON.parse(e):{}}))},Hr=function(e,t){var n,r,o=function(e){var t=e;return t.indexOf(":")>=0&&(t=t.split(":")[0]),t.indexOf("#")>=0&&(t=t.split("#")[1]),t},i=(n=e.headers,r="x-amzn-errortype",Object.keys(n).find((function(e){return e.toLowerCase()===r.toLowerCase()})));return void 0!==i?o(e.headers[i]):void 0!==t.code?o(t.code):void 0!==t.__type?o(t.__type):""},Wr=function(t){function n(e){var n=t.call(this)||this;return n.input=e,n}return e.__extends(n,t),n.prototype.resolveMiddleware=function(t,n,r){this.middlewareStack.use(e.getSerdePlugin(n,this.serialize,this.deserialize));var o=t.concat(this.middlewareStack),i={logger:n.logger,clientName:"SSOClient",commandName:"GetRoleCredentialsCommand",inputFilterSensitiveLog:vr.filterSensitiveLog,outputFilterSensitiveLog:gr.filterSensitiveLog},s=n.requestHandler;return o.resolve((function(e){return s.handle(e.request,r||{})}),i)},n.prototype.serialize=function(t,n){return function(t,n){return e.__awaiter(void 0,void 0,void 0,(function(){var r,o,i,s,a,u,c,l,d;return e.__generator(this,(function(f){switch(f.label){case 0:return[4,n.endpoint()];case 1:return r=f.sent(),o=r.hostname,i=r.protocol,s=void 0===i?"https":i,a=r.port,u=r.path,c=e.__assign({},jr(t.accessToken)&&{"x-amz-sso_bearer_token":t.accessToken}),l=((null==u?void 0:u.endsWith("/"))?u.slice(0,-1):u||"")+"/federation/credentials",d=e.__assign(e.__assign({},void 0!==t.roleName&&{role_name:t.roleName}),void 0!==t.accountId&&{account_id:t.accountId}),[2,new e.HttpRequest({protocol:s,hostname:o,port:a,method:"GET",headers:c,path:l,query:d,body:void 0})]}}))}))}(t,n)},n.prototype.deserialize=function(t,n){return function(t,n){return e.__awaiter(void 0,void 0,void 0,(function(){var r,o,i,s;return e.__generator(this,(function(a){switch(a.label){case 0:return 200!==t.statusCode&&t.statusCode>=300?[2,Cr(t,n)]:(r={$metadata:Ur(t),roleCredentials:void 0},i=e.expectNonNull,s=e.expectObject,[4,Mr(t.body,n)]);case 1:return void 0!==(o=i.apply(void 0,[s.apply(void 0,[a.sent()]),"body"])).roleCredentials&&null!==o.roleCredentials&&(r.roleCredentials=Lr(o.roleCredentials,n)),[2,Promise.resolve(r)]}}))}))}(t,n)},n}(e.Command),Kr=function(t){return e.__awaiter(void 0,void 0,void 0,(function(){var n,r;return e.__generator(this,(function(o){switch(o.label){case 0:return n=t.loadedConfig,[4,void 0===n?Kt(t):n];case 1:return r=o.sent(),[2,e.__assign(e.__assign({},r.configFile),r.credentialsFile)]}}))}))},$r=function(e){return e.profile||process.env.AWS_PROFILE||"default"},Fr=function(t){return void 0===t&&(t={}),function(){return e.__awaiter(void 0,void 0,void 0,(function(){var n,r,o,i,s,a,u,c,l,d,f,v,h;return e.__generator(this,(function(e){switch(e.label){case 0:return n=t.ssoStartUrl,r=t.ssoAccountId,o=t.ssoRegion,i=t.ssoRoleName,s=t.ssoClient,n||r||o||i?[3,2]:[4,Kr(t)];case 1:if(a=e.sent(),u=$r(t),c=a[u],!Gr(c))throw new Ie("Profile "+u+" is not configured with SSO credentials.");return l=Br(c),d=l.sso_start_url,f=l.sso_account_id,v=l.sso_region,h=l.sso_role_name,[2,Vr({ssoStartUrl:d,ssoAccountId:f,ssoRegion:v,ssoRoleName:h,ssoClient:s})];case 2:if(n&&r&&o&&i)return[2,Vr({ssoStartUrl:n,ssoAccountId:r,ssoRegion:o,ssoRoleName:i,ssoClient:s})];throw new Ie('Incomplete configuration. The fromSSO() argument hash must include "ssoStartUrl", "ssoAccountId", "ssoRegion", "ssoRoleName"');case 3:return[2]}}))}))}},Vr=function(t){var n=t.ssoStartUrl,r=t.ssoAccountId,i=t.ssoRegion,u=t.ssoRoleName,c=t.ssoClient;return e.__awaiter(void 0,void 0,void 0,(function(){var t,l,d,f,v,h,g,_,p,m,y,w,b,S;return e.__generator(this,(function(e){switch(e.label){case 0:t=a.createHash("sha1"),l=t.update(n).digest("hex"),d=s.join(Xt(),".aws","sso","cache",l+".json");try{if(f=JSON.parse(o.readFileSync(d,{encoding:"utf-8"})),new Date(f.expiresAt).getTime()-Date.now()<=9e5)throw new Error("SSO token is expired.")}catch(e){throw new Ie("The SSO session associated with this profile has expired or is otherwise invalid. To refresh this SSO session run aws sso login with the corresponding profile.",false)}v=f.accessToken,h=c||new Pr({region:i}),e.label=1;case 1:return e.trys.push([1,3,,4]),[4,h.send(new Wr({accountId:r,roleName:u,accessToken:v}))];case 2:return g=e.sent(),[3,4];case 3:throw _=e.sent(),Ie.from(_,false);case 4:if(p=g.roleCredentials,y=(m=void 0===p?{}:p).accessKeyId,w=m.secretAccessKey,b=m.sessionToken,S=m.expiration,!(y&&w&&b&&S))throw new Ie("SSO returns an invalid temporary credential.",false);return[2,{accessKeyId:y,secretAccessKey:w,sessionToken:b,expiration:new Date(S)}]}}))}))},Br=function(e){var t=e.sso_start_url,n=e.sso_account_id,r=e.sso_region,o=e.sso_role_name;if(!(t&&n&&r&&o))throw new Ie('Profile is configured with invalid SSO credentials. Required parameters "sso_account_id", "sso_region", "sso_role_name", "sso_start_url". Got '+Object.keys(e).join(", ")+"\nReference: https://docs.aws.amazon.com/cli/latest/userguide/cli-configure-sso.html",false);return e},Gr=function(e){return e&&("string"==typeof e.sso_start_url||"string"==typeof e.sso_account_id||"string"==typeof e.sso_region||"string"==typeof e.sso_role_name)},Xr=function(t){return void 0===t&&(t={}),function(){return e.__awaiter(void 0,void 0,void 0,(function(){return e.__generator(this,(function(e){return[2,Jr(t)]}))}))}},Jr=function(t){var n,r,i,s=null!==(n=null==t?void 0:t.webIdentityTokenFile)&&void 0!==n?n:process.env.AWS_WEB_IDENTITY_TOKEN_FILE,a=null!==(r=null==t?void 0:t.roleArn)&&void 0!==r?r:process.env.AWS_ROLE_ARN,u=null!==(i=null==t?void 0:t.roleSessionName)&&void 0!==i?i:process.env.AWS_ROLE_SESSION_NAME;if(!s||!a)throw new Ie("Web identity configuration not specified");return function(e){return function(){var t=e.roleArn,n=e.roleSessionName,r=e.webIdentityToken,o=e.providerId,i=e.policyArns,s=e.policy,a=e.durationSeconds,u=e.roleAssumerWithWebIdentity;if(!u)throw new Ie("Role Arn '"+t+"' needs to be assumed with web identity, but no role assumption callback was provided.",!1);return u({RoleArn:t,RoleSessionName:null!=n?n:"aws-sdk-js-session-"+Date.now(),WebIdentityToken:r,ProviderId:o,PolicyArns:i,Policy:s,DurationSeconds:a})}}(e.__assign(e.__assign({},t),{webIdentityToken:o.readFileSync(s,{encoding:"ascii"}),roleArn:a,roleSessionName:u}))()},Yr=function(e){return Boolean(e)&&"object"==typeof e&&"string"==typeof e.aws_access_key_id&&"string"==typeof e.aws_secret_access_key&&["undefined","string"].indexOf(typeof e.aws_session_token)>-1},Zr=function(e){return Boolean(e)&&"object"==typeof e&&"string"==typeof e.role_arn&&["undefined","string"].indexOf(typeof e.role_session_name)>-1&&["undefined","string"].indexOf(typeof e.external_id)>-1&&["undefined","string"].indexOf(typeof e.mfa_serial)>-1},Qr=function(t){return void 0===t&&(t={}),function(){return e.__awaiter(void 0,void 0,void 0,(function(){var n;return e.__generator(this,(function(e){switch(e.label){case 0:return[4,Kr(t)];case 1:return n=e.sent(),[2,eo($r(t),n,t)]}}))}))}},eo=function(t,n,r,o){return void 0===o&&(o={}),e.__awaiter(void 0,void 0,void 0,(function(){var i,s,a,u,c,l,d,f,v,h,g,_,p,m,y,w,b,S,E;return e.__generator(this,(function(A){switch(A.label){case 0:if(i=n[t],Object.keys(o).length>0&&Yr(i))return[2,no(i)];if(!(Zr(x=i)&&"string"==typeof x.source_profile&&void 0===x.credential_source||function(e){return Zr(e)&&"string"==typeof e.credential_source&&void 0===e.source_profile}(i)))return[3,4];if(s=i.external_id,a=i.mfa_serial,u=i.role_arn,c=i.role_session_name,l=void 0===c?"aws-sdk-js-"+Date.now():c,d=i.source_profile,f=i.credential_source,!r.roleAssumer)throw new Ie("Profile "+t+" requires a role to be assumed, but no role assumption callback was provided.",!1);if(d&&d in o)throw new Ie("Detected a cycle attempting to resolve credentials for profile "+$r(r)+". Profiles visited: "+Object.keys(o).join(", "),!1);if(v=d?eo(d,n,r,e.__assign(e.__assign({},o),((E={})[d]=!0,E))):to(f,t)(),h={RoleArn:u,RoleSessionName:l,ExternalId:s},!a)return[3,2];if(!r.mfaCodeProvider)throw new Ie("Profile "+t+" requires multi-factor authentication, but no MFA code callback was provided.",!1);return h.SerialNumber=a,g=h,[4,r.mfaCodeProvider(a)];case 1:g.TokenCode=A.sent(),A.label=2;case 2:return p=(_=r).roleAssumer,[4,v];case 3:return[2,p.apply(_,[A.sent(),h])];case 4:if(Yr(i))return[2,no(i)];if(function(e){return Boolean(e)&&"object"==typeof e&&"string"==typeof e.web_identity_token_file&&"string"==typeof e.role_arn&&["undefined","string"].indexOf(typeof e.role_session_name)>-1}(i))return[2,ro(i,r)];if(Gr(i))return m=Br(i),y=m.sso_start_url,w=m.sso_account_id,b=m.sso_region,S=m.sso_role_name,[2,Fr({ssoStartUrl:y,ssoAccountId:w,ssoRegion:b,ssoRoleName:S})()];throw new Ie("Profile "+t+" could not be found or parsed in shared credentials file.")}var x}))}))},to=function(e,t){var n={EcsContainer:Ut,Ec2InstanceMetadata:an,Environment:kt};if(e in n)return n[e]();throw new Ie("Unsupported credential source in profile "+t+". Got "+e+", expected EcsContainer or Ec2InstanceMetadata or Environment.")},no=function(e){return Promise.resolve({accessKeyId:e.aws_access_key_id,secretAccessKey:e.aws_secret_access_key,sessionToken:e.aws_session_token})},ro=function(t,n){return e.__awaiter(void 0,void 0,void 0,(function(){return e.__generator(this,(function(e){return[2,Xr({webIdentityTokenFile:t.web_identity_token_file,roleArn:t.role_arn,roleSessionName:t.role_session_name,roleAssumerWithWebIdentity:n.roleAssumerWithWebIdentity})()]}))}))},oo=function(t){return void 0===t&&(t={}),function(){return e.__awaiter(void 0,void 0,void 0,(function(){var n;return e.__generator(this,(function(e){switch(e.label){case 0:return[4,Kr(t)];case 1:return n=e.sent(),[2,io($r(t),n)]}}))}))}},io=function(t,n){return e.__awaiter(void 0,void 0,void 0,(function(){var r,o;return e.__generator(this,(function(e){switch(e.label){case 0:return r=n[t],n[t]?void 0===(o=r.credential_process)?[3,2]:[4,so(o).then((function(e){var n;try{n=JSON.parse(e)}catch(e){throw Error("Profile "+t+" credential_process returned invalid JSON.")}var r,o=n.Version,i=n.AccessKeyId,s=n.SecretAccessKey,a=n.SessionToken,u=n.Expiration;if(1!==o)throw Error("Profile "+t+" credential_process did not return Version 1.");if(void 0===i||void 0===s)throw Error("Profile "+t+" credential_process returned invalid credentials.");if(u){var c=new Date;if(new Date(u)<c)throw Error("Profile "+t+" credential_process returned expired credentials.");r=Math.floor(new Date(u).valueOf()/1e3)}return{accessKeyId:i,secretAccessKey:s,sessionToken:a,expirationUnix:r}})).catch((function(e){throw new Ie(e.message)}))]:[3,4];case 1:return[2,e.sent()];case 2:throw new Ie("Profile "+t+" did not contain credential_process.");case 3:return[3,5];case 4:throw new Ie("Profile "+t+" could not be found in shared credentials file.");case 5:return[2]}}))}))},so=function(e){return new Promise((function(t,n){d.exec(e,(function(e,r){e?n(e):t(r.trim())}))}))},ao=function(t){void 0===t&&(t={});var n=e.__assign({profile:process.env.AWS_PROFILE},t);n.loadedConfig||(n.loadedConfig=Kt(t));var r=[Fr(n),Qr(n),oo(n),Xr(n),uo(n),function(){return e.__awaiter(void 0,void 0,void 0,(function(){return e.__generator(this,(function(e){throw new Ie("Could not load credentials from any providers",!1)}))}))}];n.profile||r.unshift(kt());var o=ke.apply(void 0,e.__spreadArray([],e.__read(r),!1));return Pe(o,(function(e){return void 0!==e.expiration&&e.expiration.getTime()-Date.now()<3e5}),(function(e){return void 0!==e.expiration}))},uo=function(e){return process.env[Lt]||process.env[Dt]?Ut(e):process.env.AWS_EC2_METADATA_DISABLED?function(){return Promise.reject(new Ie("EC2 Instance Metadata Service access disabled"))}:an(e)},co={"aws-global":{hostname:"sts.amazonaws.com",signingRegion:"us-east-1"},"us-east-1-fips":{hostname:"sts-fips.us-east-1.amazonaws.com",signingRegion:"us-east-1"},"us-east-2-fips":{hostname:"sts-fips.us-east-2.amazonaws.com",signingRegion:"us-east-2"},"us-gov-east-1-fips":{hostname:"sts.us-gov-east-1.amazonaws.com",signingRegion:"us-gov-east-1"},"us-gov-west-1-fips":{hostname:"sts.us-gov-west-1.amazonaws.com",signingRegion:"us-gov-west-1"},"us-west-1-fips":{hostname:"sts-fips.us-west-1.amazonaws.com",signingRegion:"us-west-1"},"us-west-2-fips":{hostname:"sts-fips.us-west-2.amazonaws.com",signingRegion:"us-west-2"}},lo={aws:{regions:["af-south-1","ap-east-1","ap-northeast-1","ap-northeast-2","ap-northeast-3","ap-south-1","ap-southeast-1","ap-southeast-2","aws-global","ca-central-1","eu-central-1","eu-north-1","eu-south-1","eu-west-1","eu-west-2","eu-west-3","me-south-1","sa-east-1","us-east-1","us-east-1-fips","us-east-2","us-east-2-fips","us-west-1","us-west-1-fips","us-west-2","us-west-2-fips"],hostname:"sts.{region}.amazonaws.com"},"aws-cn":{regions:["cn-north-1","cn-northwest-1"],hostname:"sts.{region}.amazonaws.com.cn"},"aws-iso":{regions:["us-iso-east-1"],hostname:"sts.{region}.c2s.ic.gov"},"aws-iso-b":{regions:["us-isob-east-1"],hostname:"sts.{region}.sc2s.sgov.gov"},"aws-us-gov":{regions:["us-gov-east-1","us-gov-east-1-fips","us-gov-west-1","us-gov-west-1-fips"],hostname:"sts.{region}.amazonaws.com"}},fo=function(t,n){return e.__awaiter(void 0,void 0,void 0,(function(){return e.__generator(this,(function(r){return[2,It(t,e.__assign(e.__assign({},n),{signingService:"sts",regionHash:co,partitionHash:lo}))]}))}))},vo=function(t){var n,r,o,i,s,a,u,c,l,d,f,v,h;B(process.version);var g,_=function(e){var t,n,r,o,i;return{apiVersion:"2011-06-15",disableHostPrefix:null!==(t=null==e?void 0:e.disableHostPrefix)&&void 0!==t&&t,logger:null!==(n=null==e?void 0:e.logger)&&void 0!==n?n:{},regionInfoProvider:null!==(r=null==e?void 0:e.regionInfoProvider)&&void 0!==r?r:fo,serviceId:null!==(o=null==e?void 0:e.serviceId)&&void 0!==o?o:"STS",urlParser:null!==(i=null==e?void 0:e.urlParser)&&void 0!==i?i:Qt}}(t);return e.__assign(e.__assign(e.__assign({},_),t),{runtime:"node",base64Decoder:null!==(n=null==t?void 0:t.base64Decoder)&&void 0!==n?n:Xn,base64Encoder:null!==(r=null==t?void 0:t.base64Encoder)&&void 0!==r?r:Jn,bodyLengthChecker:null!==(o=null==t?void 0:t.bodyLengthChecker)&&void 0!==o?o:Yn,credentialDefaultProvider:null!==(i=null==t?void 0:t.credentialDefaultProvider)&&void 0!==i?i:(g=ao,function(t){return g(e.__assign({roleAssumer:mt(t,t.stsClientCtor),roleAssumerWithWebIdentity:yt(t,t.stsClientCtor)},t))}),defaultUserAgentProvider:null!==(s=null==t?void 0:t.defaultUserAgentProvider)&&void 0!==s?s:Zn({serviceId:_.serviceId,clientVersion:F}),maxAttempts:null!==(a=null==t?void 0:t.maxAttempts)&&void 0!==a?a:Yt(qn),region:null!==(u=null==t?void 0:t.region)&&void 0!==u?u:Yt(St,Et),requestHandler:null!==(c=null==t?void 0:t.requestHandler)&&void 0!==c?c:new Vn,retryMode:null!==(l=null==t?void 0:t.retryMode)&&void 0!==l?l:Yt(Wn),sha256:null!==(d=null==t?void 0:t.sha256)&&void 0!==d?d:hn.bind(null,"sha256"),streamCollector:null!==(f=null==t?void 0:t.streamCollector)&&void 0!==f?f:Gn,utf8Decoder:null!==(v=null==t?void 0:t.utf8Decoder)&&void 0!==v?v:Qn,utf8Encoder:null!==(h=null==t?void 0:t.utf8Encoder)&&void 0!==h?h:er})},ho=function(t){function n(r){var o,i,s=this,a=vo(r),u=xt(a),c=bt(u),l=jn(c),d=dr((o=l,i={stsClientCtor:n}.stsClientCtor,ut(e.__assign(e.__assign({},o),{stsClientCtor:i}))));return(s=t.call(this,d)||this).config=d,s.middlewareStack.use(pn(s.config)),s.middlewareStack.use(sr(s.config)),s.middlewareStack.use(ur(s.config)),s.middlewareStack.use(lr(s.config)),s.middlewareStack.use(kr(s.config)),s}return e.__extends(n,t),n.prototype.destroy=function(){t.prototype.destroy.call(this)},n}(e.Client),go=function(e){return void 0===e&&(e={}),yt(e,ho)},_o=function(e,t){return(_o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};var po=function(){return(po=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function mo(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function yo(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return s}function wo(e){return this instanceof wo?(this.v=e,this):new wo(e)}var bo=Object.freeze({__proto__:null,__extends:function(e,t){function n(){this.constructor=e}_o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},get __assign(){return po},__rest:function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n},__decorate:function(e,t,n,r){var o,i=arguments.length,s=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(s=(i<3?o(s):i>3?o(t,n,s):o(t,n))||s);return i>3&&s&&Object.defineProperty(t,n,s),s},__param:function(e,t){return function(n,r){t(n,r,e)}},__metadata:function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},__awaiter:function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function s(e){try{u(r.next(e))}catch(e){i(e)}}function a(e){try{u(r.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(s,a)}u((r=r.apply(e,t||[])).next())}))},__generator:function(e,t){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=s.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},__createBinding:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]},__exportStar:function(e,t){for(var n in e)"default"===n||t.hasOwnProperty(n)||(t[n]=e[n])},__values:mo,__read:yo,__spread:function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(yo(arguments[t]));return e},__spreadArrays:function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),o=0;for(t=0;t<n;t++)for(var i=arguments[t],s=0,a=i.length;s<a;s++,o++)r[o]=i[s];return r},__await:wo,__asyncGenerator:function(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,o=n.apply(e,t||[]),i=[];return r={},s("next"),s("throw"),s("return"),r[Symbol.asyncIterator]=function(){return this},r;function s(e){o[e]&&(r[e]=function(t){return new Promise((function(n,r){i.push([e,t,n,r])>1||a(e,t)}))})}function a(e,t){try{(n=o[e](t)).value instanceof wo?Promise.resolve(n.value.v).then(u,c):l(i[0][2],n)}catch(e){l(i[0][3],e)}var n}function u(e){a("next",e)}function c(e){a("throw",e)}function l(e,t){e(t),i.shift(),i.length&&a(i[0][0],i[0][1])}},__asyncDelegator:function(e){var t,n;return t={},r("next"),r("throw",(function(e){throw e})),r("return"),t[Symbol.iterator]=function(){return this},t;function r(r,o){t[r]=e[r]?function(t){return(n=!n)?{value:wo(e[r](t)),done:"return"===r}:o?o(t):t}:o}},__asyncValues:function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=mo(e),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(n){t[n]=e[n]&&function(t){return new Promise((function(r,o){(function(e,t,n,r){Promise.resolve(r).then((function(t){e({value:t,done:n})}),t)})(r,o,(t=e[n](t)).done,t.value)}))}}},__makeTemplateObject:function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e},__importStar:function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t},__importDefault:function(e){return e&&e.__esModule?e:{default:e}},__classPrivateFieldGet:function(e,t){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return t.get(e)},__classPrivateFieldSet:function(e,t,n){if(!t.has(e))throw new TypeError("attempted to set private field on non-instance");return t.set(e,n),n}}),So=f.getAugmentedNamespace(bo),Eo=f.createCommonjsModule((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Crc32=t.crc32=void 0,t.crc32=function(e){return(new n).update(e).digest()};var n=function(){function e(){this.checksum=4294967295}return e.prototype.update=function(e){var t,n;try{for(var o=So.__values(e),i=o.next();!i.done;i=o.next()){var s=i.value;this.checksum=this.checksum>>>8^r[255&(this.checksum^s)]}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}return this},e.prototype.digest=function(){return(4294967295^this.checksum)>>>0},e}();t.Crc32=n;var r=Uint32Array.from([0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117])})),Ao=function(){function e(e){if(this.bytes=e,8!==e.byteLength)throw new Error("Int64 buffers must be exactly 8 bytes")}return e.fromNumber=function(t){if(t>0x8000000000000000||t<-0x8000000000000000)throw new Error(t+" is too large (or, if negative, too small) to represent as an Int64");for(var n=new Uint8Array(8),r=7,o=Math.abs(Math.round(t));r>-1&&o>0;r--,o/=256)n[r]=o;return t<0&&xo(n),new e(n)},e.prototype.valueOf=function(){var e=this.bytes.slice(0),t=128&e[0];return t&&xo(e),parseInt(De(e),16)*(t?-1:1)},e.prototype.toString=function(){return String(this.valueOf())},e}();function xo(e){for(var t=0;t<8;t++)e[t]^=255;for(t=7;t>-1&&(e[t]++,0===e[t]);t--);}var To,Ro=function(){function t(e,t){this.toUtf8=e,this.fromUtf8=t}return t.prototype.format=function(t){var n,r,o,i,s=[];try{for(var a=e.__values(Object.keys(t)),u=a.next();!u.done;u=a.next()){var c=u.value,l=this.fromUtf8(c);s.push(Uint8Array.from([l.byteLength]),l,this.formatHeaderValue(t[c]))}}catch(e){n={error:e}}finally{try{u&&!u.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}var d=new Uint8Array(s.reduce((function(e,t){return e+t.byteLength}),0)),f=0;try{for(var v=e.__values(s),h=v.next();!h.done;h=v.next()){var g=h.value;d.set(g,f),f+=g.byteLength}}catch(e){o={error:e}}finally{try{h&&!h.done&&(i=v.return)&&i.call(v)}finally{if(o)throw o.error}}return d},t.prototype.formatHeaderValue=function(e){switch(e.type){case"boolean":return Uint8Array.from([e.value?0:1]);case"byte":return Uint8Array.from([2,e.value]);case"short":var t=new DataView(new ArrayBuffer(3));return t.setUint8(0,3),t.setInt16(1,e.value,!1),new Uint8Array(t.buffer);case"integer":var n=new DataView(new ArrayBuffer(5));return n.setUint8(0,4),n.setInt32(1,e.value,!1),new Uint8Array(n.buffer);case"long":var r=new Uint8Array(9);return r[0]=5,r.set(e.value.bytes,1),r;case"binary":var o=new DataView(new ArrayBuffer(3+e.value.byteLength));o.setUint8(0,6),o.setUint16(1,e.value.byteLength,!1);var i=new Uint8Array(o.buffer);return i.set(e.value,3),i;case"string":var s=this.fromUtf8(e.value),a=new DataView(new ArrayBuffer(3+s.byteLength));a.setUint8(0,7),a.setUint16(1,s.byteLength,!1);var u=new Uint8Array(a.buffer);return u.set(s,3),u;case"timestamp":var c=new Uint8Array(9);return c[0]=8,c.set(Ao.fromNumber(e.value.valueOf()).bytes,1),c;case"uuid":if(!Uo.test(e.value))throw new Error("Invalid UUID received: "+e.value);var l=new Uint8Array(17);return l[0]=9,l.set(function(e){if(e.length%2!=0)throw new Error("Hex encoded strings must have an even number length");for(var t=new Uint8Array(e.length/2),n=0;n<e.length;n+=2){var r=e.substr(n,2).toLowerCase();if(!(r in Oe))throw new Error("Cannot decode unrecognized sequence "+r+" as hexadecimal");t[n/2]=Oe[r]}return t}(e.value.replace(/\-/g,"")),1),l}},t.prototype.parse=function(e){for(var t={},n=0;n<e.byteLength;){var r=e.getUint8(n++),o=this.toUtf8(new Uint8Array(e.buffer,e.byteOffset+n,r));switch(n+=r,e.getUint8(n++)){case 0:t[o]={type:Io,value:!0};break;case 1:t[o]={type:Io,value:!1};break;case 2:t[o]={type:ko,value:e.getInt8(n++)};break;case 3:t[o]={type:Po,value:e.getInt16(n,!1)},n+=2;break;case 4:t[o]={type:Co,value:e.getInt32(n,!1)},n+=4;break;case 5:t[o]={type:Oo,value:new Ao(new Uint8Array(e.buffer,e.byteOffset+n,8))},n+=8;break;case 6:var i=e.getUint16(n,!1);n+=2,t[o]={type:zo,value:new Uint8Array(e.buffer,e.byteOffset+n,i)},n+=i;break;case 7:var s=e.getUint16(n,!1);n+=2,t[o]={type:No,value:this.toUtf8(new Uint8Array(e.buffer,e.byteOffset+n,s))},n+=s;break;case 8:t[o]={type:Do,value:new Date(new Ao(new Uint8Array(e.buffer,e.byteOffset+n,8)).valueOf())},n+=8;break;case 9:var a=new Uint8Array(e.buffer,e.byteOffset+n,16);n+=16,t[o]={type:Lo,value:De(a.subarray(0,4))+"-"+De(a.subarray(4,6))+"-"+De(a.subarray(6,8))+"-"+De(a.subarray(8,10))+"-"+De(a.subarray(10))};break;default:throw new Error("Unrecognized header type tag")}}return t},t}();!function(e){e[e.boolTrue=0]="boolTrue",e[e.boolFalse=1]="boolFalse",e[e.byte=2]="byte",e[e.short=3]="short",e[e.integer=4]="integer",e[e.long=5]="long",e[e.byteArray=6]="byteArray",e[e.string=7]="string",e[e.timestamp=8]="timestamp",e[e.uuid=9]="uuid"}(To||(To={}));var Io="boolean",ko="byte",Po="short",Co="integer",Oo="long",zo="binary",No="string",Do="timestamp",Lo="uuid",Uo=/^[a-f0-9]{8}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{4}-[a-f0-9]{12}$/;var qo=function(){function e(e,t){this.headerMarshaller=new Ro(e,t)}return e.prototype.marshall=function(e){var t=e.headers,n=e.body,r=this.headerMarshaller.format(t),o=r.byteLength+n.byteLength+16,i=new Uint8Array(o),s=new DataView(i.buffer,i.byteOffset,i.byteLength),a=new Eo.Crc32;return s.setUint32(0,o,!1),s.setUint32(4,r.byteLength,!1),s.setUint32(8,a.update(i.subarray(0,8)).digest(),!1),i.set(r,12),i.set(n,r.byteLength+12),s.setUint32(o-4,a.update(i.subarray(8,o-4)).digest(),!1),i},e.prototype.unmarshall=function(e){var t=function(e){var t=e.byteLength,n=e.byteOffset,r=e.buffer;if(t<16)throw new Error("Provided message too short to accommodate event stream message overhead");var o=new DataView(r,n,t),i=o.getUint32(0,!1);if(t!==i)throw new Error("Reported message length does not match received message length");var s=o.getUint32(4,!1),a=o.getUint32(8,!1),u=o.getUint32(t-4,!1),c=(new Eo.Crc32).update(new Uint8Array(r,n,8));if(a!==c.digest())throw new Error("The prelude checksum specified in the message ("+a+") does not match the calculated CRC32 checksum ("+c.digest()+")");if(c.update(new Uint8Array(r,n+8,t-12)),u!==c.digest())throw new Error("The message checksum ("+c.digest()+") did not match the expected value of "+u);return{headers:new DataView(r,n+8+4,s),body:new Uint8Array(r,n+8+4+s,i-s-16)}}(e),n=t.headers,r=t.body;return{headers:this.headerMarshaller.parse(n),body:r}},e.prototype.formatHeaders=function(e){return this.headerMarshaller.format(e)},e}();var jo=function(){function t(e){var t=e.utf8Encoder,n=e.utf8Decoder;this.eventMarshaller=new qo(t,n),this.utfEncoder=t}return t.prototype.deserialize=function(t,n){var r,o,i,s,a,u,c;return function(t,n){var r;return(r={})[Symbol.asyncIterator]=function(){return e.__asyncGenerator(this,arguments,(function(){var r,o,i,s,a,u,c,l,d,f,v,h,g,_,p,m,y;return e.__generator(this,(function(w){switch(w.label){case 0:w.trys.push([0,12,13,18]),r=e.__asyncValues(t),w.label=1;case 1:return[4,e.__await(r.next())];case 2:if((o=w.sent()).done)return[3,11];if(i=o.value,s=n.eventMarshaller.unmarshall(i),"error"!==(a=s.headers[":message-type"].value))return[3,3];throw(u=new Error(s.headers[":error-message"].value||"UnknownError")).name=s.headers[":error-code"].value,u;case 3:return"exception"!==a?[3,5]:(c=s.headers[":exception-type"].value,(_={})[c]=s,l=_,[4,e.__await(n.deserializer(l))]);case 4:if((d=w.sent()).$unknown)throw(f=new Error(n.toUtf8(s.body))).name=c,f;throw d[c];case 5:return"event"!==a?[3,9]:((p={})[s.headers[":event-type"].value]=s,v=p,[4,e.__await(n.deserializer(v))]);case 6:return(h=w.sent()).$unknown?[3,10]:[4,e.__await(h)];case 7:return[4,w.sent()];case 8:return w.sent(),[3,10];case 9:throw Error("Unrecognizable event type: "+s.headers[":event-type"].value);case 10:return[3,1];case 11:return[3,18];case 12:return g=w.sent(),m={error:g},[3,18];case 13:return w.trys.push([13,,16,17]),o&&!o.done&&(y=r.return)?[4,e.__await(y.call(r))]:[3,15];case 14:w.sent(),w.label=15;case 15:return[3,17];case 16:if(m)throw m.error;return[7];case 17:return[7];case 18:return[2]}}))}))},r}((r=t,i=0,s=0,a=null,u=null,c=function(e){if("number"!=typeof e)throw new Error("Attempted to allocate an event message where size was not a number: "+e);i=e,s=4,a=new Uint8Array(e),new DataView(a.buffer).setUint32(0,e,!1)},(o={})[Symbol.asyncIterator]=function(){return e.__asyncGenerator(this,arguments,(function(){var t,n,o,l,d,f,v,h;return e.__generator(this,(function(g){switch(g.label){case 0:t=r[Symbol.asyncIterator](),g.label=1;case 1:return[4,e.__await(t.next())];case 2:return n=g.sent(),o=n.value,n.done?i?[3,4]:[4,e.__await(void 0)]:[3,10];case 3:return[2,g.sent()];case 4:return i!==s?[3,7]:[4,e.__await(a)];case 5:return[4,g.sent()];case 6:return g.sent(),[3,8];case 7:throw new Error("Truncated event message received.");case 8:return[4,e.__await(void 0)];case 9:return[2,g.sent()];case 10:l=o.length,d=0,g.label=11;case 11:if(!(d<l))return[3,15];if(!a){if(f=l-d,u||(u=new Uint8Array(4)),v=Math.min(4-s,f),u.set(o.slice(d,d+v),s),d+=v,(s+=v)<4)return[3,15];c(new DataView(u.buffer).getUint32(0,!1)),u=null}return h=Math.min(i-s,l-d),a.set(o.slice(d,d+h),s),s+=h,d+=h,i&&i===s?[4,e.__await(a)]:[3,14];case 12:return[4,g.sent()];case 13:g.sent(),a=null,i=0,s=0,g.label=14;case 14:return[3,11];case 15:return[3,1];case 16:return[2]}}))}))},o),{eventMarshaller:this.eventMarshaller,deserializer:n,toUtf8:this.utfEncoder})},t.prototype.serialize=function(t,n){var r,o=this;return(r={})[Symbol.asyncIterator]=function(){return e.__asyncGenerator(this,arguments,(function(){var r,i,s,a,u,c,l;return e.__generator(this,(function(d){switch(d.label){case 0:d.trys.push([0,7,8,13]),r=e.__asyncValues(t),d.label=1;case 1:return[4,e.__await(r.next())];case 2:return(i=d.sent()).done?[3,6]:(s=i.value,a=o.eventMarshaller.marshall(n(s)),[4,e.__await(a)]);case 3:return[4,d.sent()];case 4:d.sent(),d.label=5;case 5:return[3,1];case 6:return[3,13];case 7:return u=d.sent(),c={error:u},[3,13];case 8:return d.trys.push([8,,11,12]),i&&!i.done&&(l=r.return)?[4,e.__await(l.call(r))]:[3,10];case 9:d.sent(),d.label=10;case 10:return[3,12];case 11:if(c)throw c.error;return[7];case 12:return[7];case 13:return[4,e.__await(new Uint8Array(0))];case 14:return[4,d.sent()];case 15:return d.sent(),[2]}}))}))},r},t}();var Mo=function(){function t(e){var t=e.utf8Encoder,n=e.utf8Decoder;this.eventMarshaller=new qo(t,n),this.universalMarshaller=new jo({utf8Decoder:n,utf8Encoder:t})}return t.prototype.deserialize=function(t,n){var r="function"==typeof t[Symbol.asyncIterator]?t:function(t){return e.__asyncGenerator(this,arguments,(function(){var n,r,o,i;return e.__generator(this,(function(s){switch(s.label){case 0:n=!1,r=!1,o=new Array,t.on("error",(function(e){if(n||(n=!0),e)throw e})),t.on("data",(function(e){o.push(e)})),t.on("end",(function(){n=!0})),s.label=1;case 1:return r?[3,6]:[4,e.__await(new Promise((function(e){return setTimeout((function(){return e(o.shift())}),0)})))];case 2:return(i=s.sent())?[4,e.__await(i)]:[3,5];case 3:return[4,s.sent()];case 4:s.sent(),s.label=5;case 5:return r=n&&0===o.length,[3,1];case 6:return[2]}}))}))}(t);return this.universalMarshaller.deserialize(r,n)},t.prototype.serialize=function(t,n){var r=this.universalMarshaller.serialize(t,n);if("function"==typeof c.Readable.from)return c.Readable.from(r);var o=r[Symbol.asyncIterator](),i=new c.Readable({autoDestroy:!0,objectMode:!0,read:function(){return e.__awaiter(this,void 0,void 0,(function(){var t=this;return e.__generator(this,(function(e){return o.next().then((function(e){var n=e.done,r=e.value;n?t.push(null):t.push(r)})).catch((function(e){t.destroy(e)})),[2]}))}))}});return i.on("error",(function(){i.destroy()})),i.on("end",(function(){i.destroy()})),i},t}(),Ho=function(e){return new Mo(e)},Wo=function(t){function n(e,n){var r=t.call(this,n)||this;return r.hash=e,r}return e.__extends(n,t),n.prototype._write=function(e,t,n){try{this.hash.update(e)}catch(e){return n(e)}n()},n}(c.Writable),Ko=function(e,t){return new Promise((function(n,r){if("string"==typeof t.path){var i=o.createReadStream(t.path,{start:t.start,end:t.end}),s=new e,a=new Wo(s);i.pipe(a),i.on("error",(function(e){a.end(),r(e)})),a.on("error",r),a.on("finish",(function(){s.digest().then(n).catch(r)}))}else r(new Error("Unable to calculate hash for non-file streams."))}))};var $o={environmentVariableSelector:function(e){if(Object.prototype.hasOwnProperty.call(e,"AWS_S3_USE_ARN_REGION")){if("true"===e.AWS_S3_USE_ARN_REGION)return!0;if("false"===e.AWS_S3_USE_ARN_REGION)return!1;throw new Error('Cannot load env AWS_S3_USE_ARN_REGION. Expected "true" or "false", got '+e.AWS_S3_USE_ARN_REGION+".")}},configFileSelector:function(e){if(Object.prototype.hasOwnProperty.call(e,"s3_use_arn_region")){if("true"===e.s3_use_arn_region)return!0;if("false"===e.s3_use_arn_region)return!1;throw new Error('Cannot load shared config entry s3_use_arn_region. Expected "true" or "false", got '+e.s3_use_arn_region+".")}},default:!1};const Fo={"accesspoint-af-south-1":{hostname:"s3-accesspoint.af-south-1.amazonaws.com"},"accesspoint-ap-east-1":{hostname:"s3-accesspoint.ap-east-1.amazonaws.com"},"accesspoint-ap-northeast-1":{hostname:"s3-accesspoint.ap-northeast-1.amazonaws.com"},"accesspoint-ap-northeast-2":{hostname:"s3-accesspoint.ap-northeast-2.amazonaws.com"},"accesspoint-ap-northeast-3":{hostname:"s3-accesspoint.ap-northeast-3.amazonaws.com"},"accesspoint-ap-south-1":{hostname:"s3-accesspoint.ap-south-1.amazonaws.com"},"accesspoint-ap-southeast-1":{hostname:"s3-accesspoint.ap-southeast-1.amazonaws.com"},"accesspoint-ap-southeast-2":{hostname:"s3-accesspoint.ap-southeast-2.amazonaws.com"},"accesspoint-ca-central-1":{hostname:"s3-accesspoint.ca-central-1.amazonaws.com"},"accesspoint-cn-north-1":{hostname:"s3-accesspoint.cn-north-1.amazonaws.com.cn"},"accesspoint-cn-northwest-1":{hostname:"s3-accesspoint.cn-northwest-1.amazonaws.com.cn"},"accesspoint-eu-central-1":{hostname:"s3-accesspoint.eu-central-1.amazonaws.com"},"accesspoint-eu-north-1":{hostname:"s3-accesspoint.eu-north-1.amazonaws.com"},"accesspoint-eu-south-1":{hostname:"s3-accesspoint.eu-south-1.amazonaws.com"},"accesspoint-eu-west-1":{hostname:"s3-accesspoint.eu-west-1.amazonaws.com"},"accesspoint-eu-west-2":{hostname:"s3-accesspoint.eu-west-2.amazonaws.com"},"accesspoint-eu-west-3":{hostname:"s3-accesspoint.eu-west-3.amazonaws.com"},"accesspoint-me-south-1":{hostname:"s3-accesspoint.me-south-1.amazonaws.com"},"accesspoint-sa-east-1":{hostname:"s3-accesspoint.sa-east-1.amazonaws.com"},"accesspoint-us-east-1":{hostname:"s3-accesspoint.us-east-1.amazonaws.com"},"accesspoint-us-east-2":{hostname:"s3-accesspoint.us-east-2.amazonaws.com"},"accesspoint-us-gov-east-1":{hostname:"s3-accesspoint.us-gov-east-1.amazonaws.com"},"accesspoint-us-gov-west-1":{hostname:"s3-accesspoint.us-gov-west-1.amazonaws.com"},"accesspoint-us-west-1":{hostname:"s3-accesspoint.us-west-1.amazonaws.com"},"accesspoint-us-west-2":{hostname:"s3-accesspoint.us-west-2.amazonaws.com"},"ap-northeast-1":{hostname:"s3.ap-northeast-1.amazonaws.com"},"ap-southeast-1":{hostname:"s3.ap-southeast-1.amazonaws.com"},"ap-southeast-2":{hostname:"s3.ap-southeast-2.amazonaws.com"},"aws-global":{hostname:"s3.amazonaws.com",signingRegion:"us-east-1"},"eu-west-1":{hostname:"s3.eu-west-1.amazonaws.com"},"fips-accesspoint-ca-central-1":{hostname:"s3-accesspoint-fips.ca-central-1.amazonaws.com"},"fips-accesspoint-us-east-1":{hostname:"s3-accesspoint-fips.us-east-1.amazonaws.com"},"fips-accesspoint-us-east-2":{hostname:"s3-accesspoint-fips.us-east-2.amazonaws.com"},"fips-accesspoint-us-gov-east-1":{hostname:"s3-accesspoint-fips.us-gov-east-1.amazonaws.com"},"fips-accesspoint-us-gov-west-1":{hostname:"s3-accesspoint-fips.us-gov-west-1.amazonaws.com"},"fips-accesspoint-us-west-1":{hostname:"s3-accesspoint-fips.us-west-1.amazonaws.com"},"fips-accesspoint-us-west-2":{hostname:"s3-accesspoint-fips.us-west-2.amazonaws.com"},"fips-us-gov-west-1":{hostname:"s3-fips.us-gov-west-1.amazonaws.com",signingRegion:"us-gov-west-1"},"s3-external-1":{hostname:"s3-external-1.amazonaws.com",signingRegion:"us-east-1"},"sa-east-1":{hostname:"s3.sa-east-1.amazonaws.com"},"us-east-1":{hostname:"s3.us-east-1.amazonaws.com"},"us-gov-east-1":{hostname:"s3.us-gov-east-1.amazonaws.com"},"us-gov-west-1":{hostname:"s3.us-gov-west-1.amazonaws.com"},"us-west-1":{hostname:"s3.us-west-1.amazonaws.com"},"us-west-2":{hostname:"s3.us-west-2.amazonaws.com"}},Vo={aws:{regions:["accesspoint-af-south-1","accesspoint-ap-east-1","accesspoint-ap-northeast-1","accesspoint-ap-northeast-2","accesspoint-ap-northeast-3","accesspoint-ap-south-1","accesspoint-ap-southeast-1","accesspoint-ap-southeast-2","accesspoint-ca-central-1","accesspoint-eu-central-1","accesspoint-eu-north-1","accesspoint-eu-south-1","accesspoint-eu-west-1","accesspoint-eu-west-2","accesspoint-eu-west-3","accesspoint-me-south-1","accesspoint-sa-east-1","accesspoint-us-east-1","accesspoint-us-east-2","accesspoint-us-west-1","accesspoint-us-west-2","af-south-1","ap-east-1","ap-northeast-1","ap-northeast-2","ap-northeast-3","ap-south-1","ap-southeast-1","ap-southeast-2","aws-global","ca-central-1","eu-central-1","eu-north-1","eu-south-1","eu-west-1","eu-west-2","eu-west-3","fips-accesspoint-ca-central-1","fips-accesspoint-us-east-1","fips-accesspoint-us-east-2","fips-accesspoint-us-west-1","fips-accesspoint-us-west-2","me-south-1","s3-external-1","sa-east-1","us-east-1","us-east-2","us-west-1","us-west-2"],hostname:"s3.{region}.amazonaws.com"},"aws-cn":{regions:["accesspoint-cn-north-1","accesspoint-cn-northwest-1","cn-north-1","cn-northwest-1"],hostname:"s3.{region}.amazonaws.com.cn"},"aws-iso":{regions:["us-iso-east-1"],hostname:"s3.{region}.c2s.ic.gov"},"aws-iso-b":{regions:["us-isob-east-1"],hostname:"s3.{region}.sc2s.sgov.gov"},"aws-us-gov":{regions:["accesspoint-us-gov-east-1","accesspoint-us-gov-west-1","fips-accesspoint-us-gov-east-1","fips-accesspoint-us-gov-west-1","fips-us-gov-west-1","us-gov-east-1","us-gov-west-1"],hostname:"s3.{region}.amazonaws.com"}},Bo=async(e,t)=>It(e,{...t,signingService:"s3",regionHash:Fo,partitionHash:Vo}),Go=t=>{var n,r,o,i,s,a,u,c,l,d,f,v,h,g,_,p,m;B(process.version);const y=(e=>{var t,n,r,o,i,s,a;return{apiVersion:"2006-03-01",disableHostPrefix:null!==(t=null==e?void 0:e.disableHostPrefix)&&void 0!==t&&t,logger:null!==(n=null==e?void 0:e.logger)&&void 0!==n?n:{},regionInfoProvider:null!==(r=null==e?void 0:e.regionInfoProvider)&&void 0!==r?r:Bo,serviceId:null!==(o=null==e?void 0:e.serviceId)&&void 0!==o?o:"S3",signingEscapePath:null!==(i=null==e?void 0:e.signingEscapePath)&&void 0!==i&&i,urlParser:null!==(s=null==e?void 0:e.urlParser)&&void 0!==s?s:Qt,useArnRegion:null!==(a=null==e?void 0:e.useArnRegion)&&void 0!==a&&a}})(t);return{...y,...t,runtime:"node",base64Decoder:null!==(n=null==t?void 0:t.base64Decoder)&&void 0!==n?n:Xn,base64Encoder:null!==(r=null==t?void 0:t.base64Encoder)&&void 0!==r?r:Jn,bodyLengthChecker:null!==(o=null==t?void 0:t.bodyLengthChecker)&&void 0!==o?o:Yn,credentialDefaultProvider:null!==(i=null==t?void 0:t.credentialDefaultProvider)&&void 0!==i?i:(w=ao,function(t){return w(e.__assign({roleAssumer:(n=t,void 0===n&&(n={}),mt(n,ho)),roleAssumerWithWebIdentity:go(t)},t));var n}),defaultUserAgentProvider:null!==(s=null==t?void 0:t.defaultUserAgentProvider)&&void 0!==s?s:Zn({serviceId:y.serviceId,clientVersion:$}),eventStreamSerdeProvider:null!==(a=null==t?void 0:t.eventStreamSerdeProvider)&&void 0!==a?a:Ho,maxAttempts:null!==(u=null==t?void 0:t.maxAttempts)&&void 0!==u?u:Yt(qn),md5:null!==(c=null==t?void 0:t.md5)&&void 0!==c?c:hn.bind(null,"md5"),region:null!==(l=null==t?void 0:t.region)&&void 0!==l?l:Yt(St,Et),requestHandler:null!==(d=null==t?void 0:t.requestHandler)&&void 0!==d?d:new Vn,retryMode:null!==(f=null==t?void 0:t.retryMode)&&void 0!==f?f:Yt(Wn),sha256:null!==(v=null==t?void 0:t.sha256)&&void 0!==v?v:hn.bind(null,"sha256"),streamCollector:null!==(h=null==t?void 0:t.streamCollector)&&void 0!==h?h:Gn,streamHasher:null!==(g=null==t?void 0:t.streamHasher)&&void 0!==g?g:Ko,useArnRegion:null!==(_=null==t?void 0:t.useArnRegion)&&void 0!==_?_:Yt($o),utf8Decoder:null!==(p=null==t?void 0:t.utf8Decoder)&&void 0!==p?p:Qn,utf8Encoder:null!==(m=null==t?void 0:t.utf8Encoder)&&void 0!==m?m:er};var w};var Xo={step:"build",tags:["SET_EXPECT_HEADER","EXPECT_HEADER"],name:"addExpectContinueMiddleware",override:!0},Jo=function(t){return{applyToStack:function(n){n.add(function(t){var n=this;return function(r){return function(o){return e.__awaiter(n,void 0,void 0,(function(){var n;return e.__generator(this,(function(i){return n=o.request,e.HttpRequest.isInstance(n)&&n.body&&"node"===t.runtime&&(n.headers=e.__assign(e.__assign({},n.headers),{Expect:"100-continue"})),[2,r(e.__assign(e.__assign({},o),{request:n}))]}))}))}}}(t),Xo)}}};var Yo={step:"initialize",tags:["VALIDATE_BUCKET_NAME"],name:"validateBucketNameMiddleware",override:!0},Zo=function(t){return{applyToStack:function(t){t.add(function(){var t=this;return function(n){return function(r){return e.__awaiter(t,void 0,void 0,(function(){var t,o;return e.__generator(this,(function(i){if("string"==typeof(t=r.input.Bucket)&&!e.validate(t)&&t.indexOf("/")>=0)throw(o=new Error("Bucket name shouldn't contain '/', received '"+t+"'")).name="InvalidBucketName",o;return[2,n(e.__assign({},r))]}))}))}}}(),Yo)}}},Qo={step:"build",tags:["USE_REGIONAL_ENDPOINT","S3"],name:"useRegionalEndpointMiddleware",override:!0},ei=function(t){return{applyToStack:function(n){n.add(function(t){return function(n){return function(r){return e.__awaiter(void 0,void 0,void 0,(function(){var o,i;return e.__generator(this,(function(s){switch(s.label){case 0:return o=r.request,!e.HttpRequest.isInstance(o)||t.isCustomEndpoint?[2,n(e.__assign({},r))]:"s3.amazonaws.com"!==o.hostname?[3,1]:(o.hostname="s3.us-east-1.amazonaws.com",[3,3]);case 1:return i="aws-global",[4,t.region()];case 2:i===s.sent()&&(o.hostname="s3.amazonaws.com"),s.label=3;case 3:return[2,n(e.__assign({},r))]}}))}))}}}(t),Qo)}}};class ti extends e.Client{constructor(t){let n=Go(t),r=xt(n),o=bt(r),i=jn(o),s=ut(i);var a,u,c,l,d,f,v,h,g,_,p;let m=function(t){return e.__assign(e.__assign({},t),{eventStreamMarshaller:t.eventStreamSerdeProvider(t)})}(dr((u=(a=s).bucketEndpoint,c=void 0!==u&&u,l=a.forcePathStyle,d=void 0!==l&&l,f=a.useAccelerateEndpoint,v=void 0!==f&&f,h=a.useDualstackEndpoint,g=void 0!==h&&h,_=a.useArnRegion,p=void 0!==_&&_,e.__assign(e.__assign({},a),{bucketEndpoint:c,forcePathStyle:d,useAccelerateEndpoint:v,useDualstackEndpoint:g,useArnRegion:"function"==typeof p?p:function(){return Promise.resolve(p)}}))));super(m),this.config=m,this.middlewareStack.use(pn(this.config)),this.middlewareStack.use(sr(this.config)),this.middlewareStack.use(ur(this.config)),this.middlewareStack.use(lr(this.config)),this.middlewareStack.use(ht(this.config)),this.middlewareStack.use(Zo(this.config)),this.middlewareStack.use(ei(this.config)),this.middlewareStack.use(Jo(this.config)),this.middlewareStack.use(kr(this.config))}destroy(){super.destroy()}}exports.S3Client=ti;
