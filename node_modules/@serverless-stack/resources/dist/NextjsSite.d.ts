import { Construct } from "constructs";
import * as s3 from "aws-cdk-lib/aws-s3";
import * as sqs from "aws-cdk-lib/aws-sqs";
import * as route53 from "aws-cdk-lib/aws-route53";
import * as cloudfront from "aws-cdk-lib/aws-cloudfront";
import * as acm from "aws-cdk-lib/aws-certificatemanager";
import { SSTConstruct } from "./Construct";
import { BaseSiteDomainProps, BaseSiteCdkDistributionProps } from "./BaseSite";
import { Permissions } from "./util/permission";
export interface NextjsSiteProps {
    path: string;
    s3Bucket?: s3.BucketProps;
    sqsRegenerationQueue?: sqs.QueueProps;
    customDomain?: string | NextjsSiteDomainProps;
    cfCachePolicies?: NextjsSiteCachePolicyProps;
    cfDistribution?: NextjsSiteCdkDistributionProps;
    environment?: {
        [key: string]: string;
    };
    defaultFunctionProps?: NextjsSiteFunctionProps;
    disablePlaceholder?: boolean;
}
export interface NextjsSiteFunctionProps {
    timeout?: number;
    memorySize?: number;
    permissions?: Permissions;
}
export interface NextjsSiteCachePolicyProps {
    staticCachePolicy?: cloudfront.ICachePolicy;
    imageCachePolicy?: cloudfront.ICachePolicy;
    lambdaCachePolicy?: cloudfront.ICachePolicy;
}
export declare type NextjsSiteDomainProps = BaseSiteDomainProps;
export declare type NextjsSiteCdkDistributionProps = BaseSiteCdkDistributionProps;
export declare class NextjsSite extends Construct implements SSTConstruct {
    static staticCachePolicyProps: cloudfront.CachePolicyProps;
    static imageCachePolicyProps: cloudfront.CachePolicyProps;
    static lambdaCachePolicyProps: cloudfront.CachePolicyProps;
    readonly s3Bucket: s3.Bucket;
    readonly sqsRegenerationQueue: sqs.Queue;
    readonly cfDistribution: cloudfront.Distribution;
    readonly hostedZone?: route53.IHostedZone;
    readonly acmCertificate?: acm.ICertificate;
    private readonly props;
    private readonly deployId;
    private readonly isPlaceholder;
    private readonly buildOutDir;
    private readonly assets;
    private readonly awsCliLayer;
    private readonly routesManifest;
    private readonly edgeLambdaRole;
    private readonly mainFunctionVersion;
    private readonly apiFunctionVersion;
    private readonly imageFunctionVersion;
    private readonly regenerationFunction;
    constructor(scope: Construct, id: string, props: NextjsSiteProps);
    get url(): string;
    get customDomainUrl(): string | undefined;
    get bucketArn(): string;
    get bucketName(): string;
    get distributionId(): string;
    get distributionDomain(): string;
    attachPermissions(permissions: Permissions): void;
    getConstructMetadata(): {
        type: "NextSite";
        data: {
            distributionId: string;
            customDomainUrl: string | undefined;
        };
    };
    private zipAppAssets;
    private zipAppStubAssets;
    private createEdgeFunction;
    private createEdgeFunctionInUE1;
    private createEdgeFunctionInNonUE1;
    private createEdgeFunctionRole;
    private createRegenerationQueue;
    private createRegenerationFunction;
    private createLambdaCodeReplacer;
    private buildApp;
    private createS3Bucket;
    private createS3Deployment;
    private createCloudFrontDistribution;
    private createCloudFrontStaticCachePolicy;
    private createCloudFrontImageCachePolicy;
    private createCloudFrontLambdaCachePolicy;
    private createCloudFrontInvalidation;
    protected validateCustomDomainSettings(): void;
    protected lookupHostedZone(): route53.IHostedZone | undefined;
    private createCertificate;
    protected createRoute53Records(): void;
    private pathPattern;
    private readRoutesManifest;
    private getS3ContentReplaceValues;
    private getLambdaContentReplaceValues;
    private registerSiteEnvironment;
}
